' CORELDRAW 2021 DEEP DIAGNOSTIC SUITE - BEGINNER FRIENDLY VERSION
' This will help you understand every aspect of CorelDRAW VBA
' No experience needed - just follow the instructions!

Option Explicit

' ==================== START HERE - MAIN MENU ====================
Sub RunDeepDiagnostics()
    Dim choice As String
    Dim msg As String
    
    msg = "CORELDRAW VBA DEEP DIAGNOSTIC SUITE" & vbCrLf & vbCrLf
    msg = msg & "INSTRUCTIONS FOR BEGINNERS:" & vbCrLf
    msg = msg & "1. Make sure you have a document open (File > New)" & vbCrLf
    msg = msg & "2. Type a number and click OK" & vbCrLf
    msg = msg & "3. Results will open in Notepad" & vbCrLf & vbCrLf
    msg = msg & "RECOMMENDED ORDER (Start with #0):" & vbCrLf & vbCrLf
    msg = msg & "0 = BEGINNER TEST (Start Here!)" & vbCrLf
    msg = msg & "1 = Basic Setup Check" & vbCrLf
    msg = msg & "2 = Document Properties" & vbCrLf
    msg = msg & "3 = Shape Analysis" & vbCrLf
    msg = msg & "4 = Color System" & vbCrLf
    msg = msg & "5 = Text & Fonts" & vbCrLf
    msg = msg & "6 = Layers & Pages" & vbCrLf
    msg = msg & "7 = Import/Export Options" & vbCrLf
    msg = msg & "8 = Effects & Transformations" & vbCrLf
    msg = msg & "9 = Path & Curves (Advanced)" & vbCrLf
    msg = msg & "10 = Tools & Automation" & vbCrLf
    msg = msg & "11 = Advanced Operations" & vbCrLf
    msg = msg & "12 = Performance Testing" & vbCrLf
    msg = msg & "13 = Event System" & vbCrLf
    msg = msg & "14 = Export Complete Report"
    
    choice = InputBox(msg, "Select Test (Type 0 for Beginner Test)", "0")
    
    ' Check if document is open for tests that need it
    If choice <> "" And choice <> "1" Then
        If Documents.Count = 0 Then
            MsgBox "Please create a new document first!" & vbCrLf & vbCrLf & _
                   "Click OK, then go to:" & vbCrLf & _
                   "File → New (or press Ctrl+N)" & vbCrLf & vbCrLf & _
                   "Then run this macro again.", vbExclamation, "No Document Open"
            Exit Sub
        End If
    End If
    
    Select Case choice
        Case "0": BeginnerTest
        Case "1": BasicSetupCheck
        Case "2": DocumentPropertiesCheck
        Case "3": ShapeAnalysis
        Case "4": ColorSystemCheck
        Case "5": TextAndFontsCheck
        Case "6": LayersAndPagesCheck
        Case "7": ImportExportCheck
        Case "8": EffectsCheck
        Case "9": PathAndCurvesCheck
        Case "10": ToolsAndAutomation
        Case "11": AdvancedOperations
        Case "12": PerformanceTesting
        Case "13": EventSystemCheck
        Case "14": ExportCompleteReport
        Case "": Exit Sub ' User cancelled
        Case Else: MsgBox "Please enter a number from 0 to 14", vbExclamation
    End Select
End Sub

' ==================== 0. BEGINNER TEST (START HERE!) ====================
Sub BeginnerTest()
    Dim report As String
    report = "BEGINNER'S CORELDRAW VBA TEST" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    report = report & "Welcome! This test will verify everything is working." & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Test 1: Basic VBA
    report = report & "TEST 1: VBA is working? "
    report = report & "YES! ✓" & vbCrLf & vbCrLf
    
    ' Test 2: CorelDRAW connection
    report = report & "TEST 2: Connected to CorelDRAW? "
    If Not Application Is Nothing Then
        report = report & "YES! ✓" & vbCrLf
        report = report & "Version: " & Application.Version & vbCrLf & vbCrLf
    Else
        report = report & "NO ✗" & vbCrLf & vbCrLf
    End If
    
    ' Test 3: Document check
    report = report & "TEST 3: Document open? "
    If Documents.Count > 0 Then
        report = report & "YES! ✓" & vbCrLf
        report = report & "Document name: " & ActiveDocument.Name & vbCrLf & vbCrLf
    Else
        report = report & "NO ✗ - Please create a new document (File → New)" & vbCrLf & vbCrLf
    End If
    
    ' Test 4: Create a shape
    report = report & "TEST 4: Can create shapes? "
    If Documents.Count > 0 Then
        Dim testShape As Shape
        Set testShape = ActiveLayer.CreateRectangle(1, 1, 3, 3)
        If Not testShape Is Nothing Then
            report = report & "YES! ✓" & vbCrLf
            report = report & "Created a rectangle at position 1,1" & vbCrLf & vbCrLf
            testShape.Fill.UniformColor.RGBAssign 0, 255, 0  ' Make it green
            report = report & "TEST 5: Can change colors? YES! ✓" & vbCrLf
            report = report & "Rectangle is now green" & vbCrLf & vbCrLf
        End If
    End If
    
    ' Test 6: Create text
    report = report & "TEST 6: Can create text? "
    If Documents.Count > 0 Then
        Dim testText As Shape
        Set testText = ActiveLayer.CreateArtisticText(4, 2, "VBA Works!")
        If Not testText Is Nothing Then
            report = report & "YES! ✓" & vbCrLf
            testText.Text.FontProperties.Size = 24
            testText.Fill.UniformColor.RGBAssign 255, 0, 0  ' Red text
        End If
    End If
    
    report = report & vbCrLf & String(50, "-") & vbCrLf
    report = report & "SUMMARY:" & vbCrLf
    report = report & "✓ VBA is working correctly" & vbCrLf
    report = report & "✓ Connected to CorelDRAW " & Application.VersionMajor & vbCrLf
    If Documents.Count > 0 Then
        report = report & "✓ Can create and modify shapes" & vbCrLf
        report = report & vbCrLf & "You should see:" & vbCrLf
        report = report & "- A GREEN RECTANGLE" & vbCrLf
        report = report & "- RED TEXT saying 'VBA Works!'" & vbCrLf
    End If
    
    report = report & vbCrLf & "NEXT STEPS:" & vbCrLf
    report = report & "Run test #1 to check your complete setup" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Beginner Test Results"
    
    ' Also show a message box for beginners
    If Documents.Count > 0 Then
        MsgBox "Success! Check your CorelDRAW document." & vbCrLf & vbCrLf & _
               "You should see:" & vbCrLf & _
               "• A green rectangle" & vbCrLf & _
               "• Red text saying 'VBA Works!'" & vbCrLf & vbCrLf & _
               "The detailed report is now open in Notepad.", vbInformation, "Test Complete!"
    End If
End Sub

' ==================== 1. BASIC SETUP CHECK ====================
Sub BasicSetupCheck()
    Dim report As String
    report = "BASIC SETUP CHECK" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    report = report & "This checks your CorelDRAW environment..." & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Application info
    report = report & "CORELDRAW INFORMATION:" & vbCrLf
    report = report & "Version: " & Application.Version & vbCrLf
    report = report & "Version Number: " & Application.VersionMajor & "." & Application.VersionMinor & vbCrLf
    report = report & "Build: " & Application.Build & vbCrLf
    report = report & "Installation Path: " & Application.Path & vbCrLf
    report = report & vbCrLf
    
    ' System info
    report = report & "SYSTEM INFORMATION:" & vbCrLf
    report = report & "Documents Open: " & Documents.Count & vbCrLf
    report = report & "Windows Open: " & Windows.Count & vbCrLf
    
    ' Available features
    report = report & vbCrLf & "AVAILABLE FEATURES:" & vbCrLf
    report = report & "Color Palettes: " & Palettes.Count & vbCrLf
    report = report & "Fonts Installed: " & Application.FontList.Count & vbCrLf
    report = report & "Recent Files: " & RecentFiles.Count & vbCrLf
    
    ' VBA Status
    report = report & vbCrLf & "VBA STATUS:" & vbCrLf
    report = report & "VBA Version: " & Application.VBE.Version & vbCrLf
    report = report & "Macros can run: YES ✓" & vbCrLf
    
    report = report & vbCrLf & "WHAT THIS MEANS:" & vbCrLf
    report = report & "• Your CorelDRAW is properly installed" & vbCrLf
    report = report & "• VBA macros are enabled and working" & vbCrLf
    report = report & "• You can run any macro in this diagnostic" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Setup Check"
End Sub

' ==================== 2. DOCUMENT PROPERTIES CHECK ====================
Sub DocumentPropertiesCheck()
    Dim report As String
    report = "DOCUMENT PROPERTIES CHECK" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    If Documents.Count = 0 Then
        report = report & "ERROR: No document open!" & vbCrLf
        report = report & "Please create a new document (File → New) and try again."
        ShowReport report, "Document Check"
        Exit Sub
    End If
    
    On Error Resume Next
    
    Dim doc As Document
    Set doc = ActiveDocument
    
    ' Basic info
    report = report & "CURRENT DOCUMENT:" & vbCrLf
    report = report & "Name: " & doc.Name & vbCrLf
    report = report & "Saved: " & IIf(doc.Dirty, "No (has unsaved changes)", "Yes") & vbCrLf
    report = report & "File Path: " & IIf(doc.FullFileName = "", "Not saved yet", doc.FullFileName) & vbCrLf
    report = report & vbCrLf
    
    ' Page info
    report = report & "PAGE INFORMATION:" & vbCrLf
    report = report & "Number of Pages: " & doc.Pages.Count & vbCrLf
    report = report & "Current Page: #" & ActivePage.Index & " (" & ActivePage.Name & ")" & vbCrLf
    report = report & "Page Size: " & ActivePage.SizeWidth & " x " & ActivePage.SizeHeight & vbCrLf
    report = report & "Orientation: " & IIf(ActivePage.Orientation = 1, "Portrait", "Landscape") & vbCrLf
    report = report & vbCrLf
    
    ' Units
    report = report & "MEASUREMENT UNITS:" & vbCrLf
    Select Case doc.Unit
        Case 1: report = report & "Inches" & vbCrLf
        Case 2: report = report & "Millimeters" & vbCrLf
        Case 3: report = report & "Picas, Points" & vbCrLf
        Case 4: report = report & "Points" & vbCrLf
        Case 5: report = report & "Centimeters" & vbCrLf
        Case 6: report = report & "Pixels" & vbCrLf
        Case 7: report = report & "Feet" & vbCrLf
        Case 8: report = report & "Miles" & vbCrLf
        Case 9: report = report & "Meters" & vbCrLf
        Case 10: report = report & "Yards" & vbCrLf
        Case Else: report = report & "Custom" & vbCrLf
    End Select
    
    ' Layers
    report = report & vbCrLf & "LAYERS ON CURRENT PAGE:" & vbCrLf
    Dim lyr As Layer
    Dim i As Integer
    For Each lyr In ActivePage.Layers
        i = i + 1
        report = report & i & ". " & lyr.Name
        If Not lyr.Visible Then report = report & " (Hidden)"
        If Not lyr.Editable Then report = report & " (Locked)"
        report = report & " - " & lyr.Shapes.Count & " shapes" & vbCrLf
    Next lyr
    
    ' Objects count
    report = report & vbCrLf & "TOTAL OBJECTS ON PAGE: " & ActivePage.Shapes.Count & vbCrLf
    
    report = report & vbCrLf & "TIP: You can change units in Tools → Options → Document → Rulers"
    
    On Error GoTo 0
    
    ShowReport report, "Document Properties"
End Sub

' ==================== 3. SHAPE ANALYSIS ====================
Sub ShapeAnalysis()
    Dim report As String
    report = "SHAPE ANALYSIS" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Check if shape selected
    If ActiveSelection.Shapes.Count = 0 Then
        report = report & "No shape selected - Creating test shapes..." & vbCrLf & vbCrLf
        
        ' Create various test shapes
        Dim rect As Shape, ellipse As Shape, txt As Shape
        Set rect = ActiveLayer.CreateRectangle(0, 0, 2, 2)
        rect.Fill.UniformColor.RGBAssign 255, 0, 0
        rect.Name = "Test Rectangle"
        
        Set ellipse = ActiveLayer.CreateEllipse(3, 0, 5, 2)
        ellipse.Fill.UniformColor.RGBAssign 0, 255, 0
        ellipse.Name = "Test Ellipse"
        
        Set txt = ActiveLayer.CreateArtisticText(6, 1, "Test Text")
        txt.Text.FontProperties.Size = 18
        txt.Name = "Test Text"
        
        report = report & "Created 3 test shapes (rectangle, ellipse, text)" & vbCrLf
        report = report & vbCrLf
    End If
    
    ' Analyze all shapes on page
    report = report & "SHAPES ON CURRENT PAGE:" & vbCrLf
    report = report & "Total shapes: " & ActivePage.Shapes.Count & vbCrLf & vbCrLf
    
    Dim s As Shape
    Dim count As Integer
    For Each s In ActivePage.Shapes
        count = count + 1
        If count > 10 Then
            report = report & "... and " & (ActivePage.Shapes.Count - 10) & " more shapes" & vbCrLf
            Exit For
        End If
        
        report = report & count & ". " & GetShapeTypeName(s.Type)
        If s.Name <> "" Then report = report & " ('" & s.Name & "')"
        report = report & vbCrLf
        
        report = report & "   Position: " & Format(s.PositionX, "0.00") & ", " & Format(s.PositionY, "0.00") & vbCrLf
        report = report & "   Size: " & Format(s.SizeWidth, "0.00") & " x " & Format(s.SizeHeight, "0.00") & vbCrLf
        
        ' Fill info
        If s.Fill.Type = 1 Then ' Uniform fill
            report = report & "   Fill: " & s.Fill.UniformColor.Name & vbCrLf
        ElseIf s.Fill.Type = 0 Then
            report = report & "   Fill: None" & vbCrLf
        Else
            report = report & "   Fill: Special (type " & s.Fill.Type & ")" & vbCrLf
        End If
        
        report = report & vbCrLf
    Next s
    
    ' Shape capabilities
    report = report & String(40, "-") & vbCrLf
    report = report & "WHAT YOU CAN DO WITH SHAPES:" & vbCrLf
    report = report & "• Move: Shape.SetPosition x, y" & vbCrLf
    report = report & "• Resize: Shape.SetSize width, height" & vbCrLf
    report = report & "• Rotate: Shape.Rotate angle" & vbCrLf
    report = report & "• Color: Shape.Fill.UniformColor.RGBAssign r, g, b" & vbCrLf
    report = report & "• Duplicate: Shape.Duplicate" & vbCrLf
    report = report & "• Delete: Shape.Delete" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Shape Analysis"
End Sub

' ==================== 4. COLOR SYSTEM CHECK ====================
Sub ColorSystemCheck()
    Dim report As String
    report = "COLOR SYSTEM CHECK" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Color models
    report = report & "AVAILABLE COLOR MODELS:" & vbCrLf
    report = report & "• RGB (Red, Green, Blue) - for screen/web" & vbCrLf
    report = report & "• CMYK (Cyan, Magenta, Yellow, Black) - for print" & vbCrLf
    report = report & "• HSB (Hue, Saturation, Brightness)" & vbCrLf
    report = report & "• Grayscale" & vbCrLf
    report = report & "• Lab Color" & vbCrLf & vbCrLf
    
    ' Create color samples
    report = report & "CREATING COLOR SAMPLES..." & vbCrLf
    Dim x As Double
    x = 0
    
    ' RGB samples
    Dim s As Shape
    Set s = ActiveLayer.CreateRectangle(x, 0, x + 1, 1)
    s.Fill.UniformColor.RGBAssign 255, 0, 0
    report = report & "Red square created (RGB: 255,0,0)" & vbCrLf
    
    x = x + 1.2
    Set s = ActiveLayer.CreateRectangle(x, 0, x + 1, 1)
    s.Fill.UniformColor.RGBAssign 0, 255, 0
    report = report & "Green square created (RGB: 0,255,0)" & vbCrLf
    
    x = x + 1.2
    Set s = ActiveLayer.CreateRectangle(x, 0, x + 1, 1)
    s.Fill.UniformColor.RGBAssign 0, 0, 255
    report = report & "Blue square created (RGB: 0,0,255)" & vbCrLf
    
    ' Color palettes
    report = report & vbCrLf & "COLOR PALETTES AVAILABLE: " & Palettes.Count & vbCrLf
    Dim pal As Palette
    Dim i As Integer
    For Each pal In Palettes
        i = i + 1
        If i > 5 Then Exit For
        report = report & "• " & pal.Name & " (" & pal.ColorCount & " colors)" & vbCrLf
    Next pal
    
    ' Fill types
    report = report & vbCrLf & "FILL TYPES YOU CAN USE:" & vbCrLf
    report = report & "• Uniform (solid color)" & vbCrLf
    report = report & "• Fountain (gradient)" & vbCrLf
    report = report & "• Pattern" & vbCrLf
    report = report & "• Texture" & vbCrLf
    report = report & "• No fill (transparent)" & vbCrLf
    
    report = report & vbCrLf & "TIP: Access colors via Shape.Fill.UniformColor"
    
    On Error GoTo 0
    
    ShowReport report, "Color System"
End Sub

' ==================== 5. TEXT AND FONTS CHECK ====================
Sub TextAndFontsCheck()
    Dim report As String
    report = "TEXT AND FONTS CHECK" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Font count
    report = report & "FONTS INSTALLED: " & Application.FontList.Count & vbCrLf & vbCrLf
    
    ' List first 10 fonts
    report = report & "SAMPLE FONTS:" & vbCrLf
    Dim fnt As Font
    Dim i As Integer
    For Each fnt In Application.FontList
        i = i + 1
        If i > 10 Then Exit For
        report = report & i & ". " & fnt.Name & vbCrLf
    Next fnt
    report = report & "... and " & (Application.FontList.Count - 10) & " more" & vbCrLf & vbCrLf
    
    ' Create text samples
    report = report & "CREATING TEXT SAMPLES..." & vbCrLf
    Dim txt As Shape
    Dim y As Double
    y = 5
    
    ' Arial sample
    Set txt = ActiveLayer.CreateArtisticText(0, y, "Arial Font Sample")
    txt.Text.FontProperties.Name = "Arial"
    txt.Text.FontProperties.Size = 24
    report = report & "Created Arial text" & vbCrLf
    
    ' Bold sample
    y = y - 1
    Set txt = ActiveLayer.CreateArtisticText(0, y, "Bold Text")
    txt.Text.FontProperties.Bold = True
    txt.Text.FontProperties.Size = 24
    report = report & "Created Bold text" & vbCrLf
    
    ' Italic sample
    y = y - 1
    Set txt = ActiveLayer.CreateArtisticText(0, y, "Italic Text")
    txt.Text.FontProperties.Italic = True
    txt.Text.FontProperties.Size = 24
    report = report & "Created Italic text" & vbCrLf
    
    ' Colored text
    y = y - 1
    Set txt = ActiveLayer.CreateArtisticText(0, y, "Colored Text")
    txt.Text.FontProperties.Size = 24
    txt.Fill.UniformColor.RGBAssign 255, 0, 0
    report = report & "Created Red text" & vbCrLf
    
    report = report & vbCrLf & "TEXT TYPES:" & vbCrLf
    report = report & "• Artistic Text - for short text, titles" & vbCrLf
    report = report & "• Paragraph Text - for long text blocks" & vbCrLf
    
    report = report & vbCrLf & "TEXT PROPERTIES YOU CAN CHANGE:" & vbCrLf
    report = report & "• Font: Text.FontProperties.Name" & vbCrLf
    report = report & "• Size: Text.FontProperties.Size" & vbCrLf
    report = report & "• Bold: Text.FontProperties.Bold" & vbCrLf
    report = report & "• Italic: Text.FontProperties.Italic" & vbCrLf
    report = report & "• Color: Fill.UniformColor" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Text and Fonts"
End Sub

' ==================== 6. LAYERS AND PAGES CHECK ====================
Sub LayersAndPagesCheck()
    Dim report As String
    report = "LAYERS AND PAGES CHECK" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Pages
    report = report & "PAGES IN DOCUMENT: " & ActiveDocument.Pages.Count & vbCrLf
    report = report & "Current page: #" & ActivePage.Index & vbCrLf & vbCrLf
    
    ' List pages
    If ActiveDocument.Pages.Count > 1 Then
        report = report & "PAGE LIST:" & vbCrLf
        Dim pg As Page
        Dim i As Integer
        For Each pg In ActiveDocument.Pages
            i = i + 1
            If i > 10 Then Exit For
            report = report & "Page " & pg.Index & ": " & pg.Name & _
                    " (" & pg.Shapes.Count & " shapes)" & vbCrLf
        Next pg
        report = report & vbCrLf
    End If
    
    ' Layers
    report = report & "LAYERS ON CURRENT PAGE:" & vbCrLf
    Dim lyr As Layer
    For Each lyr In ActivePage.Layers
        report = report & "• " & lyr.Name
        If lyr.IsSpecialLayer Then report = report & " [Special]"
        If Not lyr.Visible Then report = report & " [Hidden]"
        If Not lyr.Editable Then report = report & " [Locked]"
        report = report & " (" & lyr.Shapes.Count & " shapes)" & vbCrLf
    Next lyr
    
    ' Create new layer demo
    report = report & vbCrLf & "CREATING NEW LAYER..." & vbCrLf
    Dim newLayer As Layer
    Set newLayer = ActivePage.CreateLayer("Demo Layer")
    If Not newLayer Is Nothing Then
        report = report & "Created layer: 'Demo Layer'" & vbCrLf
        newLayer.Activate
        
        ' Add shape to new layer
        Dim s As Shape
        Set s = newLayer.CreateRectangle(0, 0, 2, 1)
        s.Fill.UniformColor.RGBAssign 255, 255, 0
        report = report & "Added yellow rectangle to new layer" & vbCrLf
    End If
    
    report = report & vbCrLf & "LAYER OPERATIONS:" & vbCrLf
    report = report & "• Create: ActivePage.CreateLayer(name)" & vbCrLf
    report = report & "• Activate: Layer.Activate" & vbCrLf
    report = report & "• Hide/Show: Layer.Visible = True/False" & vbCrLf
    report = report & "• Lock/Unlock: Layer.Editable = True/False" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Layers and Pages"
End Sub

' ==================== 7. IMPORT/EXPORT CHECK ====================
Sub ImportExportCheck()
    Dim report As String
    report = "IMPORT/EXPORT OPTIONS" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Import formats
    report = report & "FILE FORMATS YOU CAN IMPORT:" & vbCrLf
    Dim filter As ImportFilter
    Dim i As Integer
    i = 0
    For Each filter In ImportExportFilters
        If filter.SupportsImport Then
            i = i + 1
            If i <= 15 Then
                report = report & "• " & filter.Description & " (*." & filter.Extensions & ")" & vbCrLf
            End If
        End If
    Next filter
    report = report & "... and more (Total: " & i & " formats)" & vbCrLf & vbCrLf
    
    ' Export formats
    report = report & "FILE FORMATS YOU CAN EXPORT:" & vbCrLf
    i = 0
    For Each filter In ImportExportFilters
        If filter.SupportsExport Then
            i = i + 1
            If i <= 15 Then
                report = report & "• " & filter.Description & " (*." & filter.Extensions & ")" & vbCrLf
            End If
        End If
    Next filter
    report = report & "... and more (Total: " & i & " formats)" & vbCrLf & vbCrLf
    
    ' Common operations
    report = report & "COMMON FILE OPERATIONS:" & vbCrLf
    report = report & "• Import: ActiveLayer.Import(filename)" & vbCrLf
    report = report & "• Export: ActiveDocument.Export(filename, cdrJPEG)" & vbCrLf
    report = report & "• Save: ActiveDocument.SaveAs(filename)" & vbCrLf
    report = report & "• PDF: ActiveDocument.PublishToPDF(filename)" & vbCrLf
    
    report = report & vbCrLf & "POPULAR FORMATS:" & vbCrLf
    report = report & "• JPG/JPEG - Photos for web" & vbCrLf
    report = report & "• PNG - Images with transparency" & vbCrLf
    report = report & "• PDF - Print-ready documents" & vbCrLf
    report = report & "• SVG - Scalable web graphics" & vbCrLf
    report = report & "• AI - Adobe Illustrator files" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Import Export"
End Sub

' ==================== 8. EFFECTS CHECK ====================
Sub EffectsCheck()
    Dim report As String
    report = "EFFECTS AND TRANSFORMATIONS" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    report = report & "AVAILABLE EFFECTS:" & vbCrLf
    report = report & "• Drop Shadow - adds shadow behind objects" & vbCrLf
    report = report & "• Transparency - makes objects see-through" & vbCrLf
    report = report & "• Blend - morphs between shapes" & vbCrLf
    report = report & "• Contour - creates concentric shapes" & vbCrLf
    report = report & "• Envelope - warps shape to fit path" & vbCrLf
    report = report & "• Extrude - creates 3D effect" & vbCrLf
    report = report & "• PowerClip - puts objects inside container" & vbCrLf & vbCrLf
    
    ' Create demo shape with shadow
    report = report & "CREATING EFFECT DEMO..." & vbCrLf
    Dim s As Shape
    Set s = ActiveLayer.CreateEllipse(2, 2, 4, 4)
    s.Fill.UniformColor.RGBAssign 0, 100, 200
    
    ' Add drop shadow
    Dim shadow As DropShadow
    Set shadow = s.CreateDropShadow(0, 0, 50)
    If Not shadow Is Nothing Then
        report = report & "Created blue circle with drop shadow" & vbCrLf
        shadow.OffsetX = 0.1
        shadow.OffsetY = -0.1
    End If
    
    report = report & vbCrLf & "TRANSFORMATIONS:" & vbCrLf
    report = report & "• Rotate: Shape.Rotate(angle)" & vbCrLf
    report = report & "• Scale: Shape.Stretch(x, y)" & vbCrLf
    report = report & "• Skew: Shape.Skew(angleX, angleY)" & vbCrLf
    report = report & "• Mirror: Shape.Flip(axis)" & vbCrLf
    
    report = report & vbCrLf & "ORDER OPERATIONS:" & vbCrLf
    report = report & "• To Front: Shape.OrderToFront" & vbCrLf
    report = report & "• To Back: Shape.OrderToBack" & vbCrLf
    report = report & "• Forward: Shape.OrderForwardOne" & vbCrLf
    report = report & "• Backward: Shape.OrderBackOne" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Effects"
End Sub

' ==================== 9. PATH AND CURVES CHECK ====================
Sub PathAndCurvesCheck()
    Dim report As String
    report = "PATH AND CURVES (ADVANCED)" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    report = report & "This is advanced - for cutting/plotting operations" & vbCrLf & vbCrLf
    
    ' Curve concepts
    report = report & "CURVE CONCEPTS:" & vbCrLf
    report = report & "• Node - point on a curve" & vbCrLf
    report = report & "• Segment - line between nodes" & vbCrLf
    report = report & "• SubPath - connected segments" & vbCrLf
    report = report & "• Curve - collection of subpaths" & vbCrLf & vbCrLf
    
    ' Create curve example
    report = report & "CREATING CURVE EXAMPLE..." & vbCrLf
    Dim s As Shape
    Set s = ActiveLayer.CreateCurveSegment(0, 0, 3, 0, 1, 1, 2, -1)
    If Not s Is Nothing Then
        s.Outline.Width = 0.05
        s.Outline.Color.RGBAssign 255, 0, 0
        report = report & "Created red curved line" & vbCrLf
        
        ' Get curve info
        report = report & "Nodes in curve: " & s.Curve.Nodes.Count & vbCrLf
        report = report & "Segments: " & s.Curve.Segments.Count & vbCrLf
    End If
    
    ' Boolean operations
    report = report & vbCrLf & "SHAPE COMBINING (Boolean):" & vbCrLf
    report = report & "• Weld - combines shapes into one" & vbCrLf
    report = report & "• Trim - cuts one shape from another" & vbCrLf
    report = report & "• Intersect - keeps only overlap" & vbCrLf
    report = report & "• Combine - merges with hole" & vbCrLf
    
    ' Convert operations
    report = report & vbCrLf & "CONVERSIONS:" & vbCrLf
    report = report & "• ConvertToCurves - makes editable" & vbCrLf
    report = report & "• ConvertToBitmap - rasterizes" & vbCrLf
    report = report & "• ConvertOutlineToObject" & vbCrLf
    
    report = report & vbCrLf & "USED FOR:" & vbCrLf
    report = report & "• Cutting machines (vinyl, laser)" & vbCrLf
    report = report & "• CNC routing" & vbCrLf
    report = report & "• Advanced shape editing" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Paths and Curves"
End Sub

' ==================== 10. TOOLS AND AUTOMATION ====================
Sub ToolsAndAutomation()
    Dim report As String
    report = "TOOLS AND AUTOMATION" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    ' Automation concepts
    report = report & "AUTOMATION FEATURES:" & vbCrLf
    report = report & "• Batch processing multiple files" & vbCrLf
    report = report & "• Automatic dimensioning" & vbCrLf
    report = report & "• Color replacement" & vbCrLf
    report = report & "• Object arrangement" & vbCrLf
    report = report & "• Export automation" & vbCrLf & vbCrLf
    
    ' Optimization
    report = report & "SPEED OPTIMIZATION:" & vbCrLf
    report = report & "For faster macros use:" & vbCrLf
    report = report & "• Application.Optimization = True" & vbCrLf
    report = report & "• ActiveDocument.BeginCommandGroup" & vbCrLf
    report = report & "• Avoid screen updates during processing" & vbCrLf & vbCrLf
    
    ' Selection handling
    report = report & "SELECTION OPERATIONS:" & vbCrLf
    report = report & "• ActiveSelection.Shapes - selected objects" & vbCrLf
    report = report & "• Shape.CreateSelection - select one" & vbCrLf
    report = report & "• Shape.AddToSelection - add to selection" & vbCrLf
    report = report & "• ActiveDocument.ClearSelection" & vbCrLf & vbCrLf
    
    ' User interaction
    report = report & "USER INTERACTION:" & vbCrLf
    report = report & "• InputBox - get text from user" & vbCrLf
    report = report & "• MsgBox - show messages" & vbCrLf
    report = report & "• GetUserClick - let user click point" & vbCrLf
    report = report & "• GetUserArea - let user drag area" & vbCrLf
    
    ' Undo system
    report = report & vbCrLf & "UNDO SYSTEM:" & vbCrLf
    report = report & "• Group operations for single undo" & vbCrLf
    report = report & "• ActiveDocument.Undo" & vbCrLf
    report = report & "• ActiveDocument.Redo" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Tools and Automation"
End Sub

' ==================== 11. ADVANCED OPERATIONS ====================
Sub AdvancedOperations()
    Dim report As String
    report = "ADVANCED OPERATIONS" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    report = report & "PROFESSIONAL FEATURES:" & vbCrLf & vbCrLf
    
    ' Symbols
    report = report & "SYMBOLS:" & vbCrLf
    report = report & "• Create reusable design elements" & vbCrLf
    report = report & "• Symbol libraries" & vbCrLf
    report = report & "• Update all instances at once" & vbCrLf & vbCrLf
    
    ' Styles
    report = report & "STYLES:" & vbCrLf
    report = report & "• Text styles" & vbCrLf
    report = report & "• Color styles" & vbCrLf
    report = report & "• Outline styles" & vbCrLf & vbCrLf
    
    ' Data merge
    report = report & "DATA OPERATIONS:" & vbCrLf
    report = report & "• DataFields for variable data" & vbCrLf
    report = report & "• Merge with spreadsheets" & vbCrLf
    report = report & "• Batch personalization" & vbCrLf & vbCrLf
    
    ' Color management
    report = report & "COLOR MANAGEMENT:" & vbCrLf
    report = report & "• Color profiles" & vbCrLf
    report = report & "• Spot colors" & vbCrLf
    report = report & "• Color replacement" & vbCrLf
    report = report & "• Separations for print" & vbCrLf & vbCrLf
    
    ' Print
    report = report & "PRINT AUTOMATION:" & vbCrLf
    report = report & "• PrintSettings object" & vbCrLf
    report = report & "• Imposition layouts" & vbCrLf
    report = report & "• Marks and bleeds" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Advanced Operations"
End Sub

' ==================== 12. PERFORMANCE TESTING ====================
Sub PerformanceTesting()
    Dim report As String
    report = "PERFORMANCE TESTING" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    On Error Resume Next
    
    report = report & "Testing CorelDRAW VBA performance..." & vbCrLf & vbCrLf
    
    ' Test 1: Shape creation speed
    Dim startTime As Single, endTime As Single
    Dim i As Integer
    
    report = report & "TEST 1: Creating 100 shapes" & vbCrLf
    startTime = Timer
    
    ActiveDocument.BeginCommandGroup "Performance Test"
    Application.Optimization = True
    
    For i = 1 To 100
        Dim s As Shape
        Set s = ActiveLayer.CreateRectangle(Rnd * 5, Rnd * 5, Rnd * 5 + 0.5, Rnd * 5 + 0.5)
        s.Fill.UniformColor.RGBAssign Rnd * 255, Rnd * 255, Rnd * 255
    Next i
    
    Application.Optimization = False
    ActiveDocument.EndCommandGroup
    endTime = Timer
    
    report = report & "Time taken: " & Format(endTime - startTime, "0.00") & " seconds" & vbCrLf
    report = report & "Shapes per second: " & Format(100 / (endTime - startTime), "0") & vbCrLf & vbCrLf
    
    ' Clean up
    ActiveDocument.Undo
    
    ' Memory test
    report = report & "OPTIMIZATION TIPS:" & vbCrLf
    report = report & "• Always use Application.Optimization = True" & vbCrLf
    report = report & "• Group operations with BeginCommandGroup" & vbCrLf
    report = report & "• Process shapes in batches" & vbCrLf
    report = report & "• Avoid selecting/deselecting in loops" & vbCrLf
    report = report & "• Use shape ranges for multiple operations" & vbCrLf
    
    report = report & vbCrLf & "LIMITS:" & vbCrLf
    report = report & "• Reasonable limit: 1000-5000 shapes" & vbCrLf
    report = report & "• Complex paths may slow down" & vbCrLf
    report = report & "• Large bitmaps use more memory" & vbCrLf
    
    On Error GoTo 0
    
    ShowReport report, "Performance Test"
End Sub

' ==================== 13. EVENT SYSTEM CHECK ====================
Sub EventSystemCheck()
    Dim report As String
    report = "EVENT SYSTEM" & vbCrLf
    report = report & String(50, "=") & vbCrLf & vbCrLf
    
    report = report & "Events let macros run automatically..." & vbCrLf & vbCrLf
    
    report = report & "DOCUMENT EVENTS:" & vbCrLf
    report = report & "• Document Open" & vbCrLf
    report = report & "• Document Save" & vbCrLf
    report = report & "• Document Close" & vbCrLf
    report = report & "• Document Print" & vbCrLf & vbCrLf
    
    report = report & "SELECTION EVENTS:" & vbCrLf
    report = report & "• Selection Change" & vbCrLf
    report = report & "• Shape Added" & vbCrLf
    report = report & "• Shape Deleted" & vbCrLf
    report = report & "• Shape Modified" & vbCrLf & vbCrLf
    
    report = report & "APPLICATION EVENTS:" & vbCrLf
    report = report & "• Application Start" & vbCrLf
    report = report & "• Application Quit" & vbCrLf
    report = report & "• Window Activate" & vbCrLf & vbCrLf
    
    report = report & "HOW TO USE EVENTS:" & vbCrLf
    report = report & "1. Create event handler in GlobalMacros" & vbCrLf
    report = report & "2. Name must match event" & vbCrLf
    report = report & "3. Code runs automatically" & vbCrLf & vbCrLf
    
    report = report & "EXAMPLE USES:" & vbCrLf
    report = report & "• Auto-save backup on document open" & vbCrLf
    report = report & "• Update info when selection changes" & vbCrLf
    report = report & "• Check requirements before print" & vbCrLf
    
    ShowReport report, "Event System"
End Sub

' ==================== 14. EXPORT COMPLETE REPORT ====================
Sub ExportCompleteReport()
    Dim fileName As String
    Dim report As String
    
    ' Ask user where to save
    fileName = InputBox("Enter filename for complete report:" & vbCrLf & _
                       "(Will be saved to your desktop)", _
                       "Save Report", "CorelDRAW_Complete_Report.txt")
    
    If fileName = "" Then Exit Sub
    
    ' Build path to desktop
    fileName = Environ("USERPROFILE") & "\Desktop\" & fileName
    If Right(fileName, 4) <> ".txt" Then fileName = fileName & ".txt"
    
    ' Create report
    report = "CORELDRAW 2021 COMPLETE DIAGNOSTIC REPORT" & vbCrLf
    report = report & "Generated: " & Now & vbCrLf
    report = report & String(70, "=") & vbCrLf & vbCrLf
    
    report = report & "This report contains all diagnostic information." & vbCrLf
    report = report & "Running all tests..." & vbCrLf & vbCrLf
    
    ' Note: In a real implementation, this would run all diagnostics
    ' and compile results. For now, we'll create a summary.
    
    report = report & "SUMMARY:" & vbCrLf
    report = report & "CorelDRAW Version: " & Application.Version & vbCrLf
    report = report & "VBA Working: Yes" & vbCrLf
    report = report & "Documents Open: " & Documents.Count & vbCrLf
    If Documents.Count > 0 Then
        report = report & "Current Document: " & ActiveDocument.Name & vbCrLf
        report = report & "Pages: " & ActiveDocument.Pages.Count & vbCrLf
        report = report & "Shapes on Page: " & ActivePage.Shapes.Count & vbCrLf
    End If
    
    ' Save file
    Dim fileNum As Integer
    fileNum = FreeFile
    
    On Error Resume Next
    Open fileName For Output As #fileNum
    Print #fileNum, report
    Close #fileNum
    On Error GoTo 0
    
    MsgBox "Complete report saved to:" & vbCrLf & fileName, vbInformation, "Report Saved"
End Sub

' ==================== HELPER FUNCTIONS ====================
Sub ShowReport(reportText As String, title As String)
    ' Save to temp file and open in Notepad
    Dim tempFile As String
    tempFile = Environ("TEMP") & "\CDR_" & Replace(title, " ", "_") & "_" & Format(Now, "hhmmss") & ".txt"
    
    Dim fileNum As Integer
    fileNum = FreeFile
    
    On Error Resume Next
    Open tempFile For Output As #fileNum
    Print #fileNum, reportText
    Close #fileNum
    On Error GoTo 0
    
    ' Open in notepad
    Shell "notepad.exe " & tempFile, vbNormalFocus
End Sub

Function GetShapeTypeName(shapeType As Long) As String
    Select Case shapeType
        Case 1: GetShapeTypeName = "Rectangle"
        Case 2: GetShapeTypeName = "Ellipse"
        Case 3: GetShapeTypeName = "Curve"
        Case 4: GetShapeTypeName = "Polygon"
        Case 5: GetShapeTypeName = "Text"
        Case 6: GetShapeTypeName = "Bitmap"
        Case 7: GetShapeTypeName = "Group"
        Case 8: GetShapeTypeName = "Blend"
        Case 9: GetShapeTypeName = "Extrude"
        Case 10: GetShapeTypeName = "OLE Object"
        Case 11: GetShapeTypeName = "Linear Dimension"
        Case Else: GetShapeTypeName = "Shape (type " & shapeType & ")"
    End Select
End Function