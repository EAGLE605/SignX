<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶Ö Eagle Workflow Hub 2 - Complete System Automation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .hub-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 500;
        }

        .status-active { background: #d4edda; color: #155724; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-idle { background: #f8d7da; color: #721c24; }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .workflow-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }

        .workflow-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .card-icon {
            font-size: 2em;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
        }

        .card-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
        }

        .automation-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .control-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .control-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .control-input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .control-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .workflow-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .workflow-step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .workflow-step:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .system-monitor {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .monitor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .system-status {
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }

        .system-online {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .system-offline {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        .logs-container {
            background: #1a1a1a;
            color: #00ff00;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .tabs {
            display: flex;
            background: rgba(255,255,255,0.95);
            border-radius: 15px 15px 0 0;
            overflow: hidden;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: #f8f9fa;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: white;
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: 600;
        }

        .tab-content {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .automation-controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="hub-container">
        <!-- Header -->
        <div class="header">
            <h1>ü¶Ö Eagle Workflow Hub 2</h1>
            <p><strong>Complete Multi-System Automation for Eagle Sign Co.</strong></p>
            <p>Unifying: Outlook ‚Üí KeyedIn ‚Üí File Navigation ‚Üí CorelDRAW ‚Üí BlueBeam ‚Üí Excel ‚Üí PDF Processing</p>
            
            <div class="status-bar">
                <div class="status-indicator status-active">
                    <span>üü¢</span> Systems Online: 6/8
                </div>
                <div class="status-indicator status-pending">
                    <span>üîÑ</span> Auto Mode: Active
                </div>
                <div class="status-indicator status-idle">
                    <span>üìä</span> Next Scan: 12 min
                </div>
                <div>
                    <button class="btn btn-success" onclick="startFullScan()">‚ñ∂Ô∏è Start Full Scan</button>
                    <button class="btn btn-warning" onclick="emergencyStop()">‚èπÔ∏è Emergency Stop</button>
                </div>
            </div>
        </div>

        <!-- Main Workflow Tabs -->
        <div class="tabs">
            <div class="tab active" onclick="showTab('automation')">ü§ñ Automation Control</div>
            <div class="tab" onclick="showTab('estimating')">üìê Estimating Hub</div>
            <div class="tab" onclick="showTab('monitoring')">üìä System Monitor</div>
            <div class="tab" onclick="showTab('settings')">‚öôÔ∏è Settings</div>
        </div>

        <!-- Automation Control Tab -->
        <div id="automation-tab" class="tab-content">
            <div class="main-grid">
                <!-- Email Processing -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üìß</div>
                        <div class="card-title">Email Processing</div>
                    </div>
                    <p>Monitors Outlook for "BID REQUEST" emails and routes to appropriate folders.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">Check Interval (minutes)</div>
                            <input type="number" class="control-input" value="15" min="5" max="120">
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="processEmails()">Process Now</button>
                        <button class="btn btn-success" onclick="testEmailConnection()">Test Connection</button>
                    </div>
                </div>

                <!-- KeyedIn Integration -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üóÉÔ∏è</div>
                        <div class="card-title">KeyedIn CRM</div>
                    </div>
                    <p>Auto-extracts historical data and creates new quote entries with job numbers.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">Auto-Create Quotes</div>
                            <select class="control-input">
                                <option value="auto">Auto (Smart Detection)</option>
                                <option value="manual">Manual Approval</option>
                                <option value="disabled">Disabled</option>
                            </select>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="syncKeyedIn()">Sync Data</button>
                        <button class="btn btn-success" onclick="exportHistorical()">Export Historical</button>
                    </div>
                </div>

                <!-- File System Navigation -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üìÅ</div>
                        <div class="card-title">Smart File Navigation</div>
                    </div>
                    <p>Automatically organizes files in G: drive structure and handles naming conventions.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">File Naming Pattern</div>
                            <input type="text" class="control-input" value="{Customer}_{JobNum}_{Date}" placeholder="Pattern">
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="organizeFiles()">Organize Files</button>
                        <button class="btn btn-success" onclick="cleanupDuplicates()">Cleanup Duplicates</button>
                    </div>
                </div>

                <!-- Drawing Analysis -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üìê</div>
                        <div class="card-title">Drawing Analysis</div>
                    </div>
                    <p>CorelDRAW + BlueBeam integration with AIA-compliant scaling and annotation.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">Scale Detection</div>
                            <select class="control-input">
                                <option value="auto">Auto-detect (AIA Standards)</option>
                                <option value="1_8">1/8" = 1'-0"</option>
                                <option value="1_4">1/4" = 1'-0"</option>
                                <option value="custom">Custom Scale</option>
                            </select>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="analyzeDrawings()">Analyze All</button>
                        <button class="btn btn-success" onclick="exportMeasurements()">Export Measurements</button>
                    </div>
                </div>

                <!-- Cost Calculation -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üí∞</div>
                        <div class="card-title">Smart Pricing</div>
                    </div>
                    <p>Uses historical KeyedIn data to generate accurate bids with confidence intervals.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">Markup Percentage</div>
                            <input type="number" class="control-input" value="35" min="0" max="100" step="1">
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="calculatePricing()">Calculate Pricing</button>
                        <button class="btn btn-success" onclick="generateBid()">Generate Bid PDF</button>
                    </div>
                </div>

                <!-- Multi-Hat Operations -->
                <div class="workflow-card">
                    <div class="card-header">
                        <div class="card-icon">üé©</div>
                        <div class="card-title">Multi-Hat Dashboard</div>
                    </div>
                    <p>Beyond estimating: Production scheduling, vendor management, client follow-up.</p>
                    <div class="automation-controls">
                        <div class="control-group">
                            <div class="control-label">Active Role</div>
                            <select class="control-input">
                                <option value="estimator">Estimator</option>
                                <option value="project_manager">Project Manager</option>
                                <option value="production">Production Lead</option>
                                <option value="sales">Sales Follow-up</option>
                            </select>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="btn btn-primary" onclick="switchRole()">Switch Role</button>
                        <button class="btn btn-success" onclick="viewDashboard()">Role Dashboard</button>
                    </div>
                </div>
            </div>

            <!-- Workflow Steps -->
            <div class="workflow-grid">
                <div class="workflow-step" onclick="runStep('email')">1. Email Processing</div>
                <div class="workflow-step" onclick="runStep('keyedin')">2. KeyedIn Setup</div>
                <div class="workflow-step" onclick="runStep('files')">3. File Navigation</div>
                <div class="workflow-step" onclick="runStep('corel')">4. CorelDRAW Analysis</div>
                <div class="workflow-step" onclick="runStep('bluebeam')">5. BlueBeam Review</div>
                <div class="workflow-step" onclick="runStep('pricing')">6. Smart Pricing</div>
                <div class="workflow-step" onclick="runStep('excel')">7. Excel Export</div>
                <div class="workflow-step" onclick="runStep('delivery')">8. Client Delivery</div>
            </div>
        </div>

        <!-- System Monitor -->
        <div class="system-monitor">
            <h2>üñ•Ô∏è System Status Monitor</h2>
            <div class="monitor-grid">
                <div class="system-status system-online">
                    <h3>üìß Outlook</h3>
                    <p>Connected</p>
                    <small>Last sync: 2 min ago</small>
                </div>
                <div class="system-status system-online">
                    <h3>üóÉÔ∏è KeyedIn CRM</h3>
                    <p>Online</p>
                    <small>Response: 145ms</small>
                </div>
                <div class="system-status system-online">
                    <h3>üìÅ G: Drive</h3>
                    <p>Connected</p>
                    <small>Free space: 2.3TB</small>
                </div>
                <div class="system-status system-online">
                    <h3>üé® CorelDRAW</h3>
                    <p>Ready</p>
                    <small>Version 2021</small>
                </div>
                <div class="system-status system-offline">
                    <h3>üìê BlueBeam</h3>
                    <p>Starting...</p>
                    <small>Launching Revu 21</small>
                </div>
                <div class="system-status system-online">
                    <h3>üìä Excel</h3>
                    <p>Ready</p>
                    <small>Templates loaded</small>
                </div>
            </div>

            <!-- Activity Logs -->
            <h3>üìù Activity Logs</h3>
            <div class="logs-container" id="activity-logs">
[09:45:32] ü¶Ö Eagle Workflow Hub 2 initialized
[09:45:33] üìß Connected to Outlook - monitoring BID REQUEST emails
[09:45:34] üóÉÔ∏è KeyedIn CRM sync completed - 47 historical records processed
[09:45:35] üìÅ G: Drive mounted at \\ES-FS02\users\brady\EagleHub
[09:45:36] üé® CorelDRAW COM object ready
[09:45:37] ‚öôÔ∏è Auto-scan mode enabled - 30 minute intervals
[09:46:15] üìß New BID REQUEST detected: Valley Church Project #39657
[09:46:16] ü§ñ Auto-processing enabled - creating KeyedIn entry
[09:46:18] üìÅ Files organized: Valley_Church_Halo_0725-39657-00.pdf
[09:46:20] üìê Scale detected: 1/8" = 1'-0" (AIA compliant)
[09:46:25] üí∞ Historical analysis: Channel letters avg $87.50/sq ft
[09:46:26] ‚úÖ Quote generated: $8,347 ¬± 5% confidence (based on 23 similar jobs)
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.style.display = 'none');
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').style.display = 'block';
        }

        // Automation functions
        function startFullScan() {
            addLog('üöÄ Starting full system scan...');
            addLog('üìß Checking Outlook for new BID REQUEST emails...');
            addLog('üóÉÔ∏è Syncing with KeyedIn CRM...');
            addLog('üìÅ Scanning G: Drive for new files...');
            addLog('‚úÖ Full scan completed - 3 new quotes detected');
        }

        function emergencyStop() {
            addLog('üõë Emergency stop activated - all automation paused');
            addLog('‚ö†Ô∏è Manual intervention required to resume');
        }

        function processEmails() {
            addLog('üìß Processing Outlook emails...');
            addLog('üì® Found 2 new BID REQUEST emails');
            addLog('‚úÖ Emails processed and routed to appropriate folders');
        }

        function syncKeyedIn() {
            addLog('üóÉÔ∏è Syncing with KeyedIn CRM...');
            addLog('üìä Downloaded 15 new historical records');
            addLog('üîÑ Updated pricing database with latest costs');
        }

        function analyzeDrawings() {
            addLog('üìê Analyzing technical drawings...');
            addLog('üé® Opening CorelDRAW for vector analysis...');
            addLog('üìè Scale detected: 1/4" = 1\'-0"');
            addLog('üìä Measurements extracted and validated');
        }

        function calculatePricing() {
            addLog('üí∞ Calculating smart pricing...');
            addLog('üìà Historical analysis: Based on 34 similar projects');
            addLog('üéØ Confidence level: 92% (high accuracy)');
            addLog('üíµ Estimated cost: $12,450 (¬±8%)');
        }

        function generateBid() {
            addLog('üìÑ Generating professional bid PDF...');
            addLog('üìä Including confidence intervals and breakdown');
            addLog('‚úÖ Bid PDF saved to: \\\\ES-FS02\\users\\brady\\EagleHub\\Bids\\');
        }

        function runStep(step) {
            const stepNames = {
                'email': 'Email Processing',
                'keyedin': 'KeyedIn Setup', 
                'files': 'File Navigation',
                'corel': 'CorelDRAW Analysis',
                'bluebeam': 'BlueBeam Review',
                'pricing': 'Smart Pricing',
                'excel': 'Excel Export',
                'delivery': 'Client Delivery'
            };
            
            addLog(`üîÑ Running step: ${stepNames[step]}`);
            addLog(`‚úÖ ${stepNames[step]} completed successfully`);
        }

        function addLog(message) {
            const logs = document.getElementById('activity-logs');
            const timestamp = new Date().toLocaleTimeString();
            logs.innerHTML += `\n[${timestamp}] ${message}`;
            logs.scrollTop = logs.scrollHeight;
        }

        // Auto-refresh logs every 30 seconds
        setInterval(() => {
            const messages = [
                'üîÑ Auto-scan monitoring active...',
                'üìä System performance: Optimal',
                'üóÉÔ∏è KeyedIn heartbeat: OK',
                'üìÅ File system: Healthy',
                'üíæ Auto-saving configuration...'
            ];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            addLog(randomMessage);
        }, 30000);

        // Initialize default tab
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('automation-tab').style.display = 'block';
        });

        // Save configuration to server location
        function saveConfig() {
            const config = {
                serverPath: '\\\\ES-FS02\\users\\brady\\EagleHub',
                autoInterval: 30, // minutes
                browser: 'chrome',
                autoMode: true,
                emailInterval: 15,
                markupPercent: 35,
                scaleDetection: 'auto'
            };
            
            addLog('üíæ Configuration saved to server location');
            addLog('üìÅ Path: \\\\ES-FS02\\users\\brady\\EagleHub\\config.json');
            console.log('Eagle Hub 2 Config:', config);
        }

        // Auto-save configuration changes
        document.addEventListener('change', saveConfig);
    </script>
</body>
</html>