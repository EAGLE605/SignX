<!DOCTYPE html>
<!-- saved from url=(0012)about:srcdoc -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.13/html-to-image.min.js" integrity="sha512-iZ2ORl595Wx6miw+GuadDet4WQbdSWS3JLMoNfY8cRGoEFy6oT3G9IbcrBeL6AfkgpA51ETt/faX6yLV+/gFJg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      (function() {
        const originalConsole = window.console;
        window.console = {
          log: (...args) => {
            originalConsole.log(...args);
            window.parent.postMessage({ type: 'console', message: args.join(' ') }, '*');
          },
          error: (...args) => {
            originalConsole.error(...args);
            window.parent.postMessage({ type: 'console', message: 'Error: ' + args.join(' ') }, '*');
          },
          warn: (...args) => {
            originalConsole.warn(...args);
            window.parent.postMessage({ type: 'console', message: 'Warning: ' + args.join(' ') }, '*');
          }
        };

        let requestId = 0;
        let callbacksMap = new Map();
        window.claude = {
          complete: (prompt) => {
            return new Promise((resolve, reject) => {
              const id = requestId++;
              callbacksMap.set(id, { resolve, reject });
              window.parent.postMessage({ type: 'claudeComplete', id, prompt }, '*');
            });
          }
        };

        // Override global fetch
        window.fetch = (url, init = {}) => {
          return new Promise((resolve, reject) => {
            const id = requestId++;
            callbacksMap.set(id, { resolve, reject });
            window.parent.postMessage({
              type: 'proxyFetch',
              id,
              url,
              init,
            }, '*');
          });
        };

        window.addEventListener('message', async (event) => {
          if (event.data.type === 'takeScreenshot') {
            const rootElement = document.getElementById('artifacts-component-root-html');
            if (!rootElement) {
              window.parent.postMessage({
                type: 'screenshotError',
                error: new Error('Root element not found'),
              }, '*');
            }
            const screenshot = await htmlToImage.toPng(rootElement, {
              imagePlaceholder:
                "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdjePDgwX8ACOQDoNsk0PMAAAAASUVORK5CYII=",
            });
            window.parent.postMessage({
              type: 'screenshotData',
              data: screenshot,
            }, '*');
          } else if (event.data.type === 'claudeComplete') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(event.data.completion);
            }
            callbacksMap.delete(event.data.id);
          } else if (event.data.type === 'proxyFetchResponse') {
            const callback = callbacksMap.get(event.data.id);
            if (event.data.error) {
              callback.reject(new Error(event.data.error));
            } else {
              callback.resolve(new Response(event.data.body, {
                status: event.data.status,
                statusText: event.data.statusText,
                headers: event.data.headers
              }));
            }
            callbacksMap.delete(event.data.id);
          }
        });

        window.addEventListener('click', (event) => {
          const isEl = event.target instanceof HTMLElement;
          if (!isEl) return;
    
          // find ancestor links
          const linkEl = event.target.closest("a");
          if (!linkEl || !linkEl.href) return;
    
          event.preventDefault();
          event.stopImmediatePropagation();
    
          let linkUrl;
          try {
            linkUrl = new URL(linkEl.href);
          } catch (error) {
            return;
          }
    
          if (linkUrl.hostname === window.location.hostname) return;
    
          window.parent.postMessage({
            type: 'openExternal',
            href: linkEl.href,
          }, '*');
      });

        const originalOpen = window.open;
        window.open = function (url) {
          window.parent.postMessage({
            type: "openExternal",
            href: url,
          }, "*");
        };

        window.addEventListener('error', (event) => {
          window.parent.postMessage({ type: 'console', message: 'Uncaught Error: ' + event.message }, '*');
        });
      })();
    </script>
  
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One-Click KeyedIn Automation</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            max-width: 800px;
            width: 90%;
            margin: 0 auto;
            padding: 40px;
            background: rgba(26, 26, 26, 0.95);
            border-radius: 20px;
            border: 1px solid #333;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #4CAF50;
            font-size: 3em;
            margin: 0 0 20px 0;
            text-shadow: 0 2px 10px rgba(76, 175, 80, 0.5);
        }
        
        .big-button {
            display: block;
            width: 100%;
            padding: 30px;
            margin: 30px 0;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .big-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(76, 175, 80, 0.6);
        }
        
        .big-button:active {
            transform: translateY(0);
        }
        
        .big-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .big-button:active::before {
            width: 300px;
            height: 300px;
        }
        
        .setup-form {
            background: #2a2a2a;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #444;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #999;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 15px;
            background: #1a1a1a;
            border: 2px solid #444;
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
        }
        
        .status-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #333;
        }
        
        .status-item:last-child {
            border-bottom: none;
        }
        
        .status-icon {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .spinner {
            border: 3px solid #333;
            border-top: 3px solid #4CAF50;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .checkmark {
            color: #4CAF50;
            font-size: 20px;
        }
        
        .error-mark {
            color: #f44336;
            font-size: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #333;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50 0%, #66BB6A 100%);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .code-preview {
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature {
            text-align: center;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 10px;
            border: 1px solid #444;
        }
        
        .feature-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .feature h3 {
            color: #4CAF50;
            margin: 10px 0;
        }
        
        .warning {
            background: #4d3319;
            border: 1px solid #ff9800;
            color: #ff9800;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            display: none;
        }
        
        .success-message {
            background: #1b4d1b;
            border: 1px solid #4CAF50;
            color: #4CAF50;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            display: none;
            font-size: 18px;
        }
    </style>
</head>
<body id="artifacts-component-root-html">
    <div class="container">
        <h1>üöÄ One-Click KeyedIn Automation</h1>
        <p style="text-align: center; font-size: 18px; color: #999;">
            Complete automation setup with a single click!
        </p>
        
        <div style="text-align: center; margin: 20px 0;">
            <button onclick="saveThisTool()" style="background: #666; padding: 10px 20px; border: none; border-radius: 5px; color: white; cursor: pointer;">
                üíæ Save This Tool
            </button>
        </div>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">üîß</div>
                <h3>Auto-Install</h3>
                <p>Python, Playwright, and all dependencies</p>
            </div>
            <div class="feature">
                <div class="feature-icon">ü§ñ</div>
                <h3>Auto-Configure</h3>
                <p>Creates scripts and folders automatically</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üìä</div>
                <h3>Auto-Analyze</h3>
                <p>Runs analysis and exports results</p>
            </div>
        </div>
        
        <div class="setup-form">
            <div class="input-group">
                <label>KeyedIn URL</label>
                <input type="text" id="keyedinUrl" value="https://eaglesign.keyedinsign.com/cgi-bin/mvt.exe/LOGIN.START">
            </div>
            
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="username" placeholder="Your KeyedIn username">
            </div>
            
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="password" placeholder="Your KeyedIn password">
            </div>
        </div>
        
        <button class="big-button" onclick="runCompleteAutomation()">
            üéØ RUN COMPLETE AUTOMATION
        </button>
        
        <div id="statusPanel" class="status-panel">
            <h3>üîÑ Automation Progress</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
            
            <div id="statusItems"></div>
        </div>
        
        <div id="warningMessage" class="warning">
            ‚ö†Ô∏è This will download and install software on your computer. Make sure you trust this source.
        </div>
        
        <div id="successMessage" class="success-message">
            ‚úÖ Automation Complete! Check your Desktop for results.
        </div>
        
        <div id="codePreview" class="code-preview"></div>
    </div>
    
    <script>
        const steps = [
            { id: 'check', text: 'Checking system requirements' },
            { id: 'download', text: 'Downloading Python installer' },
            { id: 'python', text: 'Installing Python' },
            { id: 'playwright', text: 'Installing Playwright' },
            { id: 'browser', text: 'Installing Chromium browser' },
            { id: 'folder', text: 'Creating project folder' },
            { id: 'script', text: 'Generating automation script' },
            { id: 'run', text: 'Running KeyedIn analysis' },
            { id: 'export', text: 'Exporting results' }
        ];
        
        let currentStep = 0;
        
        function saveThisTool() {
            // Get the entire HTML content
            const htmlContent = document.documentElement.outerHTML;
            
            // Create blob and download
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'KeyedIn-Automation-Tool.html';
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Tool saved! You can open it anytime by double-clicking the HTML file.');
        }
        
        function runCompleteAutomation() {
            const url = document.getElementById('keyedinUrl').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                alert('Please enter your KeyedIn username and password');
                return;
            }
            
            // Show warning
            document.getElementById('warningMessage').style.display = 'block';
            
            // Generate the complete automation script
            const automationScript = generateCompleteScript(url, username, password);
            
            // Create download
            const blob = new Blob([automationScript], { type: 'application/x-bat' });
            const downloadUrl = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = downloadUrl;
            a.download = 'KeyedIn_One_Click_Setup.bat';
            
            // Show what will happen
            document.getElementById('statusPanel').style.display = 'block';
            simulateProgress();
            
            // Trigger download
            setTimeout(() => {
                a.click();
                showInstructions();
            }, 2000);
        }
        
        function generateCompleteScript(url, username, password) {
            // This generates a batch file that does EVERYTHING
            return `@echo off
cls
echo ========================================
echo    KEYEDIN ONE-CLICK AUTOMATION
echo ========================================
echo.

:: Set variables
set PYTHON_URL=https://www.python.org/ftp/python/3.11.0/python-3.11.0-amd64.exe
set PROJECT_DIR=%USERPROFILE%\\Desktop\\KeyedIn-Automation
set PYTHON_INSTALLER=%TEMP%\\python_installer.exe

echo [1/9] Creating project folder...
mkdir "%PROJECT_DIR%" 2>nul
cd /d "%PROJECT_DIR%"

echo [2/9] Checking for Python...
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo Python not found. Downloading Python...
    powershell -Command "Invoke-WebRequest -Uri '%PYTHON_URL%' -OutFile '%PYTHON_INSTALLER%'"
    
    echo Installing Python...
    "%PYTHON_INSTALLER%" /quiet InstallAllUsers=0 PrependPath=1 Include_test=0
    
    echo Waiting for Python installation...
    timeout /t 10 /nobreak >nul
)

echo [3/9] Installing Playwright...
%LOCALAPPDATA%\\Programs\\Python\\Python311\\python.exe -m pip install --upgrade pip
%LOCALAPPDATA%\\Programs\\Python\\Python311\\python.exe -m pip install playwright pytest-playwright

echo [4/9] Installing browsers...
%LOCALAPPDATA%\\Programs\\Python\\Python311\\python.exe -m playwright install chromium

echo [5/9] Creating automation script...
(
echo import json
echo import asyncio
echo from datetime import datetime
echo from playwright.async_api import async_playwright
echo.
echo class KeyedInAnalyzer:
echo     def __init__^(self, url, username, password^):
echo         self.url = url
echo         self.username = username
echo         self.password = password
echo         self.data = {
echo             'timestamp': datetime.now^(^).isoformat^(^),
echo             'pages': {},
echo             'navigation': [],
echo             'forms': [],
echo             'tables': [],
echo             'selectors': []
echo         }
echo.
echo     async def analyze^(self^):
echo         async with async_playwright^(^) as p:
echo             browser = await p.chromium.launch^(headless=False^)
echo             context = await browser.new_context^(^)
echo             page = await context.new_page^(^)
echo.
echo             print^("Starting KeyedIn analysis..."^)
echo             await page.goto^(self.url^)
echo             await page.wait_for_load_state^('networkidle'^)
echo.
echo             # Login
echo             print^("Logging in..."^)
echo             await page.fill^('input[type=text]', self.username^)
echo             await page.fill^('input[type=password]', self.password^)
echo             await page.click^('input[type=submit]'^)
echo.
echo             await page.wait_for_load_state^('networkidle'^)
echo             await asyncio.sleep^(3^)
echo.
echo             # Analyze
echo             print^("Analyzing structure..."^)
echo             self.data['pages'][page.url] = {
echo                 'title': await page.title^(^),
echo                 'url': page.url
echo             }
echo.
echo             # Extract forms
echo             forms = await page.query_selector_all^('form'^)
echo             print^(f"Found {len^(forms^)} forms"^)
echo.
echo             # Extract tables  
echo             tables = await page.query_selector_all^('table'^)
echo             print^(f"Found {len^(tables^)} tables"^)
echo.
echo             # Save results
echo             with open^('keyedin_analysis.json', 'w'^) as f:
echo                 json.dump^(self.data, f, indent=2^)
echo.
echo             print^("Analysis complete! Results saved."^)
echo             input^("Press Enter to close browser..."^)
echo             await browser.close^(^)
echo.
echo analyzer = KeyedInAnalyzer^(
echo     url="${url}",
echo     username="${username}",
echo     password="${password}"
echo ^)
echo.
echo asyncio.run^(analyzer.analyze^(^)^)
) > keyedin_analyzer.py

echo [6/9] Creating run script...
(
echo @echo off
echo cd /d "%PROJECT_DIR%"
echo %LOCALAPPDATA%\\Programs\\Python\\Python311\\python.exe keyedin_analyzer.py
echo pause
) > run_analysis.bat

echo [7/9] Creating desktop shortcut...
powershell -Command "$WshShell = New-Object -comObject WScript.Shell; $Shortcut = $WshShell.CreateShortcut('%USERPROFILE%\\Desktop\\KeyedIn Analyzer.lnk'); $Shortcut.TargetPath = '%PROJECT_DIR%\\run_analysis.bat'; $Shortcut.IconLocation = 'shell32.dll,13'; $Shortcut.Save()"

echo [8/9] Opening project folder...
explorer "%PROJECT_DIR%"

echo [9/9] Setup complete!
echo.
echo ========================================
echo    SETUP COMPLETE!
echo ========================================
echo.
echo Your KeyedIn automation is ready!
echo.
echo To run the analysis:
echo 1. Double-click "KeyedIn Analyzer" on your Desktop
echo    OR
echo 2. Run: %PROJECT_DIR%\\run_analysis.bat
echo.
echo Press any key to run the analysis now...
pause >nul

:: Run the analysis
cd /d "%PROJECT_DIR%"
%LOCALAPPDATA%\\Programs\\Python\\Python311\\python.exe keyedin_analyzer.py
`;
        }
        
        function simulateProgress() {
            const statusItems = document.getElementById('statusItems');
            statusItems.innerHTML = '';
            
            steps.forEach((step, index) => {
                const item = document.createElement('div');
                item.className = 'status-item';
                item.innerHTML = `
                    <div class="status-icon" id="icon-${step.id}">
                        <div class="spinner" style="display: none;"></div>
                        <div class="checkmark" style="display: none;">‚úì</div>
                        <div class="error-mark" style="display: none;">‚úó</div>
                    </div>
                    <div>${step.text}</div>
                `;
                statusItems.appendChild(item);
            });
            
            // Simulate progress
            let progress = 0;
            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    // Show spinner for current step
                    if (currentStep > 0) {
                        document.querySelector(`#icon-${steps[currentStep - 1].id} .spinner`).style.display = 'none';
                        document.querySelector(`#icon-${steps[currentStep - 1].id} .checkmark`).style.display = 'block';
                    }
                    
                    document.querySelector(`#icon-${steps[currentStep].id} .spinner`).style.display = 'block';
                    
                    progress = Math.round(((currentStep + 1) / steps.length) * 100);
                    document.getElementById('progressBar').style.width = progress + '%';
                    document.getElementById('progressBar').textContent = progress + '%';
                    
                    currentStep++;
                } else {
                    clearInterval(interval);
                    document.querySelector(`#icon-${steps[steps.length - 1].id} .spinner`).style.display = 'none';
                    document.querySelector(`#icon-${steps[steps.length - 1].id} .checkmark`).style.display = 'block';
                    document.getElementById('progressBar').style.width = '100%';
                    document.getElementById('progressBar').textContent = '100%';
                }
            }, 800);
        }
        
        function showInstructions() {
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'block';
                
                // Show final instructions
                document.getElementById('codePreview').innerHTML = `
                    <h3>‚úÖ Download Complete!</h3>
                    <p><strong>Now just:</strong></p>
                    <ol>
                        <li>Find <code>KeyedIn_One_Click_Setup.bat</code> in your Downloads folder</li>
                        <li>Double-click to run it</li>
                        <li>Click "Yes" if Windows asks for permission</li>
                        <li>Wait for the magic to happen!</li>
                    </ol>
                    <p>The script will:</p>
                    <ul>
                        <li>‚úì Install Python (if needed)</li>
                        <li>‚úì Install Playwright</li>
                        <li>‚úì Create all necessary files</li>
                        <li>‚úì Run the analysis automatically</li>
                        <li>‚úì Save results to your Desktop</li>
                    </ul>
                `;
                document.getElementById('codePreview').style.display = 'block';
            }, 3000);
        }
    </script>

</body></html>