# **Complete Sign Shop Workflow Package**
## **FULL DETAILED VERSION - Everything From Our Session**

---

## **YES - CREATE A CLAUDE PROJECT!**

### **How to Create a Claude Project:**
1. Go to Claude.ai
2. Look for "Projects" in the sidebar (or create from the menu)
3. Name it: "Sign Shop Estimating Workflow"
4. Upload this document as your project knowledge
5. Set project instructions: "I'm documenting and automating my sign shop estimation workflow. We're currently 60% complete."

---

## **PROJECT STATUS SUMMARY**

### **Where We Are Now (EXACT STATE):**
- Opened Valley Church CorelDRAW file: `Valley Church Halo Flange Letters Front Elev 0725-39657.cdr`
- Clicked OK on font substitution dialog (fonts will be converted to curves later)
- Zoomed ALL the way out (you said "i am going to simply zoom allll the way out")
- Can see EVERYTHING in the file:
  - Multiple versions of Valley Church sign
  - Photos of actual building (for reference)
  - "BRADY TAKEOFF" section (that's you!)
  - Circled version (CRN circled it because of many revisions)
  - Various design iterations
- You said: "hey look! its circled this time due to how many reveisions and other art CRN needed to play with to make it right"

### **What's Complete (60-70%):**
✅ Email workflow (Outlook folders by salesperson)  
✅ KeyedIn navigation (multiple popups, specific JavaScript functions)  
✅ Quote search and filtering (only "BID REQUEST" matters)  
✅ PDF attachment handling (determines software choice)  
✅ File system navigation (G: drive alphabetical, messy folders)  
✅ Software selection logic (Nagle = Bluebeam, technical = CorelDRAW)  

### **What's Not Done Yet:**
❌ Scale verification in CorelDRAW (next step!)
❌ Measurement extraction (what CRN didn't dimension)  
❌ Eagle template macros  
❌ Bluebeam calibration (for raster files)
❌ Excel pricing integration  
❌ Closing the loop back to KeyedIn  

---

## **COMPLETE DETAILED WORKFLOW DOCUMENTATION**

### **Phase 0: Email Discovery (The REAL Starting Point)**

You corrected me when I missed this! Email is where it all starts.

**Outlook Folder Structure:**
```
Inbox
├── BID REQUEST              ← Main folder for new quotes
│   ├── Jeff                 ← jeff@eaglesign.net
│   ├── Joe                  ← joe@eaglesign.net  
│   ├── Rich                 ← rich@eaglesign.net
│   └── Mike E               ← mike.e@eaglesign.net (retired)
```

**Critical Details You Emphasized:**
- "BID REQUEST" is the keyword
- Email address determines which folder
- Mike E is retired but folder remains
- ALL folders are priority (you corrected me when I assumed priority order)
- Check throughout the day

---

### **Phase 1: KeyedIn Login and Navigation**

**Login URL**: `https://eaglesign.keyedinsign.com/cgi-bin/mvi.exe/LOGIN.START`

**After Login Dashboard:**
- Dark gray left menu (you noted color #505050)
- Widgets mostly show "No Tasks currently assigned to you"
- You click "CRM" to expand menu

**Critical Navigation Function:**
```javascript
openNew('CONTACT.MANAGEMENT','CRM.STD')
```
This opens Contact Management in a NEW TAB (not same window!)

**Your Exact Process:**
1. Click "CRM" in left menu
2. Menu expands showing options
3. Click "Contact Management"
4. NEW TAB opens (this is important - multiple tabs/popups)

---

### **Phase 2: Quote Search in Contact Management**

**Search Interface:**
- Dropdown is already set to "Quote Number" (your system is configured this way)
- You type the quote number and hit Enter or click "Go"

**Example Quote Numbers from Session:**
- 39658 (Northwestern Mutual)
- 39657 (Valley Church) ← The one we're working on
- 38092 (has Sales Order but customer changed mind!)

---

### **Phase 3: Quote List Analysis**

After search, you click **"Show Quotes"** button (blue) which opens ANOTHER popup.

**What Quote List Shows:**
- ALL quotes for that customer (can be 50+ spanning years!)
- Status column is CRITICAL:
  - "BID REQUEST" = You need to estimate these
  - "BID COMPLETED" = Already done
  - Sales Order number = Sold (but check for changes!)

**Complex Case You Showed:**
- Quote 38092: Shows Sales Order 12101 BUT "they actually approved art and signed off on the quote and via email changed their mind"
- Quote 38093: "sold and hasnt changed as we told them its already in production"

---

### **Phase 4: Quote Details**

Clicking quote number opens YET ANOTHER popup (you're managing multiple windows now!)

**Three Tabs:**
1. **Description**: Basic sign info
2. **Construction**: Special notes (often empty)
3. **Attachments**: THE CRITICAL TAB

**Attachment Process:**
- Click Attachments tab
- Find PDF conceptual art
- Double-click opens in new browser tab
- This determines your workflow path

---

### **Phase 5: Software Decision**

**Your Rules:**
- **Nagle Signs** = "NOTORIOUS for sending up raster images in pdf" → ALWAYS Bluebeam
- **Photo/rendering** = Bluebeam
- **Technical drawing with Eagle template** = CorelDRAW
- **Interior graphics** = Usually Bluebeam

**From Your Example:**
- Northwestern Mutual (Nagle) = Photo rendering → Bluebeam
- Valley Church = Technical drawing → CorelDRAW

---

### **Phase 6: File System Navigation**

**G: Drive Structure:**
```
G:\
├── 0-9\
├── A\
├── B\
...
├── V\
│   └── Valley Church\    ← "kind of a mess and tricky to navigate"
└── Z\
```

**Valley Church Folder Reality (Your Exact Words):**
- "kind of a mess and tricky to navigate"
- "something you'll have to do on your own to pull up the CORRECT, Verified, VALIDATED drawing"

**Real Files You Showed:**
- `Valley Church Halo Flange Letters Front Elev 0725-39657.cdr` ← CORRECT ONE
- `Valley Church Edge Lit Letters Front Elev 0725-39658-00.cdr`
- Multiple other versions with different dates
- Some just named like "38092.cdr" with no description!

---

### **Phase 7: CorelDRAW File Opening**

**What Happens:**
1. Double-click the .cdr file
2. Font substitution dialog ALWAYS appears
3. You said: "clicking okay because it doesnt matter right now....everything important for production will be converted to curves not a font"
4. File opens showing initial view

**The Zoom Out Revelation:**
- You: "now i am going to simply zoom allll the way out and see everything in the file!"
- What appears: EVERYTHING IS IN ONE FILE
- Multiple versions scattered around
- Photos of the actual building
- "BRADY TAKEOFF" section
- Circled final version

**Your Key Insight:**
"hey look! its circled this time due to how many reveisions and other art CRN needed to play with to make it right you also see BRADY TAKEOFF...yeah thats me!"

---

### **Phase 8: Current State - Ready for Scale Verification**

**What's on Screen Now:**
- Multiple versions of Valley Church sign
- The circled version that matches quote 39657
- Dimensions shown: 1.83' × 13.6' = 24.9 SQ FT
- Actually: 22" height × 13'7" width
- Your BRADY TAKEOFF section ready for work

**Critical Scale Facts:**
- Drawings are NEVER at full scale
- Common scales: 1/4" = 1'-0"
- You said about CRN: "designer CRN is pretty spot on with scaling"
- But also: "youre not going to find it at full scale imported"

**What Happens Next (Not Documented Yet):**
- Verify scale (measure known dimension)
- Extract missing dimensions
- Run Eagle macros if available
- Create takeoff in your section

---

## **DETAILED PAIN POINTS FROM SESSION**

1. **Quote Status Confusion**: Customer approved then changed mind (38092)
2. **File Organization**: "kind of a mess and tricky to navigate"
3. **Multiple Versions**: Everything saved in one file by CRN
4. **Scale Issues**: Never imports at full scale
5. **Missing Dimensions**: "letter spacing will never be called out"
6. **Designer Patterns**: Each designer has different habits

---

## **SPECIFIC CORRECTIONS YOU MADE**

1. **Email First**: I missed that email was the starting point
2. **No Folder Priority**: All salespeople equally important
3. **File Selection**: "MAKE SURE YOURE GRABBING OR MEASURING THE CORRECT ONE"
4. **Scale Reality**: "you wont always get dimensions"
5. **Designer Files**: May contain full scale drawing if you zoom out

---

## **KEY QUOTES FROM YOU**

- "uhhh....youre not looking at balley church drawing......youre looking at northwestern mutal drawing from nagle sign"
- "it may be hard to decipher but here is a drawing done by nagle signs"
- "you'll have enough to scale and one dimension or the other and THEN extract and annotate what CRN left out"
- "perfect example here..the height is called out for the logo at 17.25" but not the width"
- "doesnt matter....and honestly if we were to open up coreldraw and open the file...if you zoom out...there's likely a full scale drawing in there"

---

## **CONTINUATION PROMPT WITH FULL CONTEXT**

```
I'm continuing my sign shop estimation workflow documentation. Last session we went through my entire process from Outlook email to opening CorelDRAW. 

Current state: Valley Church file (0725-39657.cdr) is open in CorelDRAW. I've zoomed all the way out and can see:
- Multiple versions CRN saved in one file
- Photos of the actual building
- My "BRADY TAKEOFF" section
- The circled version that matches the PDF
- Drawing shows 22" height

Next: I need to document scale verification. When I measure the 22" height on screen with CorelDRAW's ruler, it measures 5.5". Show me how to document this scale verification and measurement extraction process.

Note: CRN is usually accurate with scales but it's never 1:1. I need to verify scale, then extract dimensions CRN didn't provide (like letter spacing, individual letter heights in stacked text, logo widths when only height is given).
```

---

## **COMPLETE AUTOMATION CODE WITH ALL DETAILS**

```python
#!/usr/bin/env python3
"""
Sign Shop Estimating Workflow Automation
Based on ACTUAL workflow observed in detail
Total time: 15-45 minutes per quote (Brady's actual timeframe)

Key Details:
- Email starts in Outlook BID REQUEST folders
- KeyedIn uses specific JavaScript functions
- Multiple popups/windows open simultaneously  
- G: drive is "kind of a mess and tricky to navigate"
- CorelDRAW files contain EVERYTHING in one file
"""

import asyncio
import json
import logging
import os
import re
import subprocess
import time
from dataclasses import dataclass
from datetime import datetime
from pathlib import Path
from typing import Dict, List, Optional, Tuple

import win32com.client  # For Outlook
from dotenv import load_dotenv
from playwright.async_api import Page, async_playwright

load_dotenv()

# Constants from actual workflow
KEYEDIN_URL = "https://eaglesign.keyedinsign.com/cgi-bin/mvi.exe/LOGIN.START"
G_DRIVE_PATH = Path("G:/")
SALESPEOPLE = ["Jeff", "Joe", "Rich", "Mike E"]  # Mike E retired but folder remains

# File patterns Brady actually sees
QUOTE_PATTERNS = [
    r'(\d{4})-(\d{5})',  # 0725-39657
    r'Quote[#\s]*(\d{5})',  # Quote #39657
    r'(\d{5})',  # Just 39657
]

class OutlookMonitor:
    """Monitor Outlook BID REQUEST folders - THE REAL STARTING POINT"""
    
    def __init__(self):
        self.outlook = win32com.client.Dispatch("Outlook.Application")
        self.namespace = self.outlook.GetNamespace("MAPI")
        
    def check_bid_request_folders(self) -> List[Dict]:
        """Check ALL salesperson folders - they're all equal priority"""
        emails = []
        
        # Navigate to BID REQUEST folder
        inbox = self.namespace.GetDefaultFolder(6)
        bid_request_folder = None
        
        for folder in inbox.Folders:
            if folder.Name == "BID REQUEST":
                bid_request_folder = folder
                break
                
        if not bid_request_folder:
            logging.error("BID REQUEST folder not found!")
            return emails
            
        # Check each salesperson - NO PRIORITY ORDER
        for salesperson in SALESPEOPLE:
            try:
                sp_folder = bid_request_folder.Folders[salesperson]
                
                for item in sp_folder.Items:
                    if item.UnRead and "BID REQUEST" in item.Subject:
                        # Extract quote numbers - they're 5 digits, typically 30000-99999
                        quotes = re.findall(r'\b\d{5}\b', item.Body)
                        quotes = [q for q in quotes if 30000 <= int(q) <= 99999]
                        
                        if quotes:
                            emails.append({
                                'quotes': quotes,
                                'salesperson': salesperson,
                                'from': item.SenderEmailAddress,
                                'subject': item.Subject,
                                'received': item.ReceivedTime
                            })
                            
                            item.UnRead = False  # Mark as read
                            
            except Exception as e:
                logging.warning(f"Error checking {salesperson} folder: {e}")
                
        return emails

class KeyedInAutomation:
    """
    Handle KeyedIn CRM - LEGACY SYSTEM WITH NO API
    Everything is browser-based with multiple popups
    """
    
    def __init__(self):
        self.username = os.getenv('KEYEDIN_USERNAME')
        self.password = os.getenv('KEYEDIN_PASSWORD')
        self.page = None
        self.contact_page = None
        self.popups = {}  # Track ALL the popups
        
    async def initialize(self):
        playwright = await async_playwright().start()
        self.browser = await playwright.chromium.launch(
            headless=False,  # MUST see what's happening
            args=['--start-maximized']
        )
        self.context = await self.browser.new_context(
            viewport={'width': 1920, 'height': 1080},
            accept_downloads=True
        )
        self.page = await self.context.new_page()
        
    async def login(self):
        """Login to KeyedIn - exact process Brady showed"""
        await self.page.goto(KEYEDIN_URL)
        
        # Fill credentials
        await self.page.fill('input[type="text"]', self.username)
        await self.page.fill('input[type="password"]', self.password)
        await self.page.click('input[type="submit"]')
        
        # Wait for dashboard with dark gray menu
        await self.page.wait_for_load_state('networkidle')
        await asyncio.sleep(3)
        
        # Verify we see CRM in menu
        if not await self.page.locator('text="CRM"').count():
            raise Exception("Login failed - CRM menu not found")
            
    async def open_contact_management(self):
        """Navigate using the EXACT JavaScript function"""
        # Click CRM to expand menu
        await self.page.click('text="CRM"')
        await asyncio.sleep(1)
        
        # Use the specific JavaScript function Brady showed
        await self.page.evaluate("openNew('CONTACT.MANAGEMENT','CRM.STD')")
        
        # Wait for new tab
        await asyncio.sleep(3)
        
        # Get the Contact Management page (new tab)
        if len(self.context.pages) > 1:
            self.contact_page = self.context.pages[-1]
            await self.contact_page.bring_to_front()
            return self.contact_page
        else:
            raise Exception("Contact Management failed to open in new tab")
            
    async def search_and_process_quote(self, quote_number: str) -> Dict:
        """
        Search for quote and handle the multiple popups
        Returns quote details including attachment type
        """
        if not self.contact_page:
            raise Exception("Contact Management not open")
            
        # Search for quote (already set to Quote Number)
        search_box = self.contact_page.locator('input[type="text"]').first
        await search_box.clear()
        await search_box.fill(quote_number)
        await search_box.press('Enter')
        
        await self.contact_page.wait_for_load_state('networkidle')
        await asyncio.sleep(2)
        
        # Click Show Quotes - opens ANOTHER popup
        with self.contact_page.expect_popup() as popup_info:
            await self.contact_page.click('text="Show Quotes"')
            
        quotes_popup = await popup_info.value
        await quotes_popup.wait_for_load_state('networkidle')
        
        # Find our quote in the list - must be BID REQUEST
        quote_data = await self._find_bid_request_quote(quotes_popup, quote_number)
        
        if not quote_data:
            await quotes_popup.close()
            return None
            
        # Click quote for details - opens YET ANOTHER popup
        with quotes_popup.expect_popup() as detail_popup_info:
            await quotes_popup.click(f'text="{quote_number}"')
            
        detail_popup = await detail_popup_info.value
        await detail_popup.wait_for_load_state('networkidle')
        
        # Get details and attachments
        quote_data.update(await self._extract_quote_details(detail_popup, quote_number))
        
        # Clean up popups
        await detail_popup.close()
        await quotes_popup.close()
        
        return quote_data
        
    async def _find_bid_request_quote(self, popup: Page, quote_number: str) -> Optional[Dict]:
        """Find quote in list - MUST be BID REQUEST status"""
        rows = await popup.locator('tr').all()
        
        for row in rows:
            cells = await row.locator('td').all()
            if len(cells) >= 5:  # Need at least 5 columns
                quote_cell = await cells[0].text_content()
                status_cell = await cells[4].text_content()
                
                if quote_number in quote_cell and "BID REQUEST" in status_cell:
                    return {
                        'quote': quote_number,
                        'status': 'BID REQUEST',
                        'row_element': row
                    }
                    
        return None
        
    async def _extract_quote_details(self, popup: Page, quote_number: str) -> Dict:
        """Extract details from quote popup - especially attachments"""
        details = {
            'description': '',
            'attachments': [],
            'has_nagle': False,  # Nagle = always raster
            'artwork_type': None
        }
        
        # Get description
        try:
            desc = await popup.locator('.description-content').text_content()
            details['description'] = desc
            
            # Check for Nagle (always raster)
            if 'nagle' in desc.lower():
                details['has_nagle'] = True
                details['artwork_type'] = 'Bluebeam'
        except:
            pass
            
        # Click Attachments tab - THE CRITICAL TAB
        await popup.click('text="Attachments"')
        await asyncio.sleep(1)
        
        # Get PDF attachments
        pdf_links = await popup.locator('a[href*=".pdf"], a[href*=".PDF"]').all()
        
        for link in pdf_links:
            filename = await link.text_content()
            details['attachments'].append(filename)
            
            # Download it
            with popup.expect_download() as download_info:
                await link.click()
                
            download = await download_info.value
            save_path = Path(f"downloads/{quote_number}_{filename}")
            await download.save_as(save_path)
            
        # Determine software if not already set
        if not details['artwork_type']:
            if any('interior' in att.lower() for att in details['attachments']):
                details['artwork_type'] = 'Bluebeam'
            else:
                details['artwork_type'] = 'CorelDRAW'  # Default for technical
                
        return details

class FileSystemNavigator:
    """
    Navigate G: drive - "kind of a mess and tricky to navigate"
    Must find CORRECT, Verified, VALIDATED drawing
    """
    
    @staticmethod
    def find_customer_files(customer_name: str, quote_number: str) -> Dict:
        """Find files in the messy customer folder"""
        first_letter = customer_name[0].upper()
        customer_path = G_DRIVE_PATH / first_letter / customer_name
        
        results = {
            'folder_path': customer_path,
            'all_files': [],
            'quote_files': [],
            'best_match': None
        }
        
        if not customer_path.exists():
            logging.warning(f"Customer folder not found: {customer_path}")
            return results
            
        # Get ALL files first to see the mess
        all_files = list(customer_path.iterdir())
        results['all_files'] = [f.name for f in all_files]
        
        # Find files with our quote number
        for pattern in [f"*{quote_number}*", f"*{quote_number[1:]}*"]:  # Sometimes missing first digit
            matches = list(customer_path.glob(pattern))
            results['quote_files'].extend(matches)
            
        # Remove duplicates
        results['quote_files'] = list(set(results['quote_files']))
        
        # Find best match - prefer .cdr with correct quote and -00 revision
        for f in results['quote_files']:
            if f.suffix.lower() == '.cdr' and f'-{quote_number}' in f.name:
                if '-00' in f.name or results['best_match'] is None:
                    results['best_match'] = f
                    
        return results
        
    @staticmethod
    def validate_file_choice(file_path: Path, quote_number: str) -> bool:
        """
        Validate we have the CORRECT file
        Brady emphasized: "MAKE SURE YOURE GRABBING OR MEASURING THE CORRECT ONE"
        """
        if not file_path.exists():
            return False
            
        # Must contain quote number
        if quote_number not in file_path.name:
            return False
            
        # Prefer -00 revision
        if '-01' in file_path.name or '-02' in file_path.name:
            logging.warning(f"This is a revision: {file_path.name}")
            
        return True
        
    @staticmethod
    def open_in_coreldraw(file_path: Path):
        """Open in CorelDRAW - prepare for scale verification"""
        coreldraw = r"C:\Program Files\Corel\CorelDRAW Graphics Suite 2021\Programs64\CorelDRW.exe"
        subprocess.Popen([coreldraw, str(file_path)])
        logging.info(f"Opened in CorelDRAW: {file_path}")
        logging.info("NEXT: Click OK on font dialog, then ZOOM OUT to see everything!")
        
    @staticmethod  
    def open_in_bluebeam(file_path: Path):
        """Open in Bluebeam for raster/Nagle artwork"""
        bluebeam = r"C:\Program Files\Bluebeam Software\Bluebeam Revu\Revu.exe"
        subprocess.Popen([bluebeam, str(file_path)])
        logging.info(f"Opened in Bluebeam: {file_path}")
        logging.info("NEXT: Calibrate scale - NEVER trust typed scale!")

# Main workflow
async def process_quote_workflow():
    """
    Complete workflow from email to software opening
    Target: 15-45 minutes per quote
    """
    
    # Initialize components
    outlook = OutlookMonitor()
    keyedin = KeyedInAutomation()
    file_nav = FileSystemNavigator()
    
    # Setup KeyedIn
    await keyedin.initialize()
    await keyedin.login()
    await keyedin.open_contact_management()
    
    # Check emails
    emails = outlook.check_bid_request_folders()
    
    for email in emails:
        logging.info(f"Processing email from {email['salesperson']}: {email['quotes']}")
        
        for quote_number in email['quotes']:
            logging.info(f"\n{'='*50}")
            logging.info(f"Processing Quote: {quote_number}")
            logging.info('='*50)
            
            # Search in KeyedIn
            quote_data = await keyedin.search_and_process_quote(quote_number)
            
            if not quote_data:
                logging.warning(f"Quote {quote_number} not found or not BID REQUEST")
                continue
                
            # Determine customer name (would come from quote data)
            customer = "Valley Church"  # Example
            
            # Find files
            file_results = file_nav.find_customer_files(customer, quote_number)
            
            logging.info(f"Found {len(file_results['all_files'])} total files in folder")
            logging.info(f"Found {len(file_results['quote_files'])} files matching quote")
            
            if file_results['best_match']:
                logging.info(f"Best match: {file_results['best_match'].name}")
                
                # Validate choice
                if file_nav.validate_file_choice(file_results['best_match'], quote_number):
                    # Open in appropriate software
                    if quote_data['artwork_type'] == 'CorelDRAW':
                        file_nav.open_in_coreldraw(file_results['best_match'])
                    else:
                        file_nav.open_in_bluebeam(file_results['best_match'])
                        
                    logging.info("File opened - ready for scale verification!")
                else:
                    logging.error("File validation failed!")
            else:
                logging.error(f"No matching files found for {quote_number}")

if __name__ == "__main__":
    asyncio.run(process_quote_workflow())
```

---

## **ALL SCREENSHOT DESCRIPTIONS IN DETAIL**

### **Screenshot 1: Outlook BID REQUEST Folders**
- Left sidebar shows folder hierarchy
- BID REQUEST folder is expanded
- Four subfolders visible: Jeff, Joe, Rich, Mike E
- Email preview shows quote numbers in subject/body

### **Screenshot 2: KeyedIn Dashboard After Login**
- Dark gray menu on left (#505050 or #797979)
- "CRM" menu item visible (not yet clicked)
- Main area has widgets:
  - CRM Followup List (empty)
  - FYI - For Your Information! 
  - Assigned Milestone List (shows "No Tasks")
  - Assigned Service Calls (shows "No Tasks")

### **Screenshot 3: Contact Management Search**
- New browser tab opened
- Search dropdown showing "Quote Number" selected
- Empty text input box
- "Go" button to the right
- "Use a List: (NO LIST)" dropdown below

### **Screenshot 4: Quote List Popup (Northwestern Mutual)**
- Account shows: "016545 | Northwestern Mutual"
- Multiple quotes listed in table
- Status column shows mix of:
  - "BID REQUEST" (ones you need to estimate)
  - "BID COMPLETED" 
  - Some have Sales Order numbers
- Quote 38092: Has SO# 12101 but customer changed mind!
- Quote 38093: In production, can't change

### **Screenshot 5: Quote Detail Popup (Valley Church)**
- Shows Quote #39657
- Three tabs visible: Description | Construction | Attachments
- Currently on Attachments tab
- PDF file visible for download

### **Screenshot 6: G: Drive File Browser**
- Path: G:\V\Valley Church\
- MESSY folder with many files:
  - Different date prefixes (0624, 0625, 0725)
  - Various naming patterns
  - Some just numbers like "38092.cdr"
- Target file: Valley Church Halo Flange Letters Front Elev 0725-39657.cdr

### **Screenshot 7: CorelDRAW Open Dialog**
- Navigating to find the correct .cdr file
- File list shows multiple versions
- Looking for 0725-39657 specifically

### **Screenshot 8: CorelDRAW Zoomed Out - THE BIG REVEAL**
- Multiple versions of Valley Church sign scattered around
- Photos of actual building (reference photos)
- "BRADY TAKEOFF" section (that's where you work!)
- One version is CIRCLED (the final one)
- Drawing info shows: 1.83' × 13.6' = 24.9 SQ FT
- Actually: 22" height × 13'7" width (you corrected this)

---

## **CRITICAL REMINDERS**

1. **Email is the TRUE starting point** - not KeyedIn
2. **"BID REQUEST" is the only status that matters**
3. **Scale is NEVER 1:1** - always needs verification
4. **Files are messy** - your exact words: "kind of a mess and tricky to navigate"
5. **Everything in one file** - CRN saves all versions together
6. **You are BRADY** - the BRADY TAKEOFF section is yours
7. **15-45 minutes** - your actual time per quote

---

**This is the COMPLETE detailed documentation from our entire session!**

---

## **YES - CREATE A CLAUDE PROJECT!**

### **How to Create a Claude Project:**
1. Go to Claude.ai
2. Look for "Projects" in the sidebar (or create from the menu)
3. Name it: "Sign Shop Estimating Workflow"
4. Upload this document as your project knowledge
5. Add any screenshots you have
6. Set project instructions: "I'm documenting and automating my sign shop estimation workflow. We're currently 60% complete."

---

## **PROJECT STATUS SUMMARY**

### **Where We Are Now:**
- Opened Valley Church CorelDRAW file (0725-39657.cdr)
- Clicked OK on font substitution dialog
- Zoomed out to see everything (multiple versions, BRADY TAKEOFF section)
- **READY TO START**: Scale verification and measurement process

### **What's Complete (60-70%):**
✅ Email workflow (Outlook folders)  
✅ KeyedIn navigation (all popups)  
✅ Quote search and filtering  
✅ PDF attachment handling  
✅ File system navigation  
✅ Software selection logic  

### **What's Not Done Yet:**
❌ Scale verification in CorelDRAW  
❌ Measurement extraction  
❌ Eagle template macros  
❌ Bluebeam calibration  
❌ Excel pricing integration  
❌ Closing the loop back to KeyedIn  

---

## **CONTINUATION PROMPT**
*Copy this when starting a new session:*

```
I'm continuing my sign shop estimation workflow documentation. Last session we documented the complete workflow from Outlook email through KeyedIn CRM to opening files in CorelDRAW. 

We stopped at: Valley Church file open in CorelDRAW, zoomed out, showing multiple versions and BRADY TAKEOFF section. 

Next: Document scale verification and measurement extraction process.

Key context:
- Workflow takes 15-45 minutes per quote
- Using Playwright for automation, not Selenium
- KeyedIn is legacy (no API) - browser only
- Scales are never 1:1, always need verification
- Designer CRN usually has accurate scales
```

---

## **COMPLETE WORKFLOW DOCUMENTATION**

### **Quick Reference**
- **KeyedIn URL**: `https://eaglesign.keyedinsign.com/cgi-bin/mvi.exe/LOGIN.START`
- **Contact Management JS**: `openNew('CONTACT.MANAGEMENT','CRM.STD')`
- **Salespeople**: Jeff, Joe, Rich, Mike E (retired)
- **File Pattern**: G:\[First Letter]\[Customer Name]\
- **Quote Pattern**: 5 digits (30000-99999)
- **Critical Status**: "BID REQUEST" only

### **Phase 0: Email Organization**
```
Outlook Structure:
BID REQUEST/
├── Jeff/     (jeff@eaglesign.net)
├── Joe/      (joe@eaglesign.net)
├── Rich/     (rich@eaglesign.net)
└── Mike E/   (mike.e@eaglesign.net) [retired]
```

### **Phase 1: KeyedIn Navigation**
1. Login → Dashboard → CRM → Contact Management
2. Search by Quote Number
3. Show Quotes → Find "BID REQUEST" status
4. Open Quote → Attachments tab → Download PDFs

### **Phase 2: Software Decision**
- **Nagle Signs** → Always Bluebeam (raster)
- **Interior graphics** → Bluebeam
- **Technical drawings** → CorelDRAW
- **Eagle templates** → CorelDRAW

### **Phase 3: File Finding**
```
G:\V\Valley Church\
├── Valley Church Halo Flange Letters Front Elev 0725-39657.cdr  ← CORRECT
├── Valley Church Edge Lit Letters Front Elev 0725-39658-00.cdr
├── Valley Church Halo Letters 0824-38093.cdr  ← WRONG (different date)
└── [30+ other files...]
```

### **Phase 4: CorelDRAW Current State**
- File opened, font dialog dismissed
- Zoomed out (Shift+F4)
- Multiple versions visible
- BRADY TAKEOFF section ready
- Circled version identified

---

## **COMPLETE AUTOMATION CODE**

```python
#!/usr/bin/env python3
"""
Sign Shop Estimating Workflow Automation
Email → KeyedIn → File System → CorelDRAW/Bluebeam
"""

import asyncio
import os
import re
from pathlib import Path
from typing import Dict, List, Optional
import win32com.client  # For Outlook
from playwright.async_api import Page, async_playwright
from dotenv import load_dotenv

load_dotenv()

# Constants
KEYEDIN_URL = "https://eaglesign.keyedinsign.com/cgi-bin/mvi.exe/LOGIN.START"
G_DRIVE_PATH = Path("G:/")

class OutlookMonitor:
    """Monitor BID REQUEST folders in Outlook"""
    def __init__(self):
        self.outlook = win32com.client.Dispatch("Outlook.Application")
        self.namespace = self.outlook.GetNamespace("MAPI")
        
    def get_bid_request_emails(self) -> List[Dict]:
        emails = []
        inbox = self.namespace.GetDefaultFolder(6)
        
        # Find BID REQUEST folder
        for folder in inbox.Folders:
            if folder.Name == "BID REQUEST":
                # Check each salesperson
                for sp in ["Jeff", "Joe", "Rich", "Mike E"]:
                    try:
                        sp_folder = folder.Folders[sp]
                        for item in sp_folder.Items:
                            if item.UnRead and "BID REQUEST" in item.Subject:
                                quotes = re.findall(r'\b\d{5}\b', item.Body)
                                emails.append({
                                    'quotes': quotes,
                                    'salesperson': sp,
                                    'subject': item.Subject
                                })
                                item.UnRead = False
                    except:
                        pass
        return emails

class KeyedInAutomation:
    """Handle KeyedIn CRM navigation"""
    def __init__(self):
        self.username = os.getenv('KEYEDIN_USERNAME')
        self.password = os.getenv('KEYEDIN_PASSWORD')
        
    async def initialize(self):
        playwright = await async_playwright().start()
        self.browser = await playwright.chromium.launch(headless=False)
        self.context = await self.browser.new_context()
        self.page = await self.context.new_page()
        
    async def login(self):
        await self.page.goto(KEYEDIN_URL)
        await self.page.fill('input[type="text"]', self.username)
        await self.page.fill('input[type="password"]', self.password)
        await self.page.click('input[type="submit"]')
        await self.page.wait_for_load_state('networkidle')
        
    async def search_quote(self, quote_number: str):
        # Navigate to Contact Management
        await self.page.click('text="CRM"')
        await self.page.evaluate("openNew('CONTACT.MANAGEMENT','CRM.STD')")
        await asyncio.sleep(3)
        
        # Switch to new tab
        contact_page = self.context.pages[-1]
        
        # Search
        await contact_page.fill('input[type="text"]', quote_number)
        await contact_page.press('input[type="text"]', 'Enter')
        
        # Show Quotes
        await contact_page.click('text="Show Quotes"')
        # ... continue with popup handling

class FileSystemNavigator:
    """Navigate G: drive and find files"""
    @staticmethod
    def find_customer_files(customer: str, quote: str) -> List[Path]:
        first_letter = customer[0].upper()
        customer_path = G_DRIVE_PATH / first_letter / customer
        
        if customer_path.exists():
            return list(customer_path.glob(f"*{quote}*"))
        return []

# Scale verification utilities
def calculate_scale_factor(measured: float, actual: float) -> float:
    """Calculate scale factor from measurements"""
    return actual / measured

def verify_scale_consistency(measurements: List[tuple]) -> bool:
    """Verify scale is consistent across multiple measurements"""
    factors = [actual/measured for measured, actual in measurements]
    avg = sum(factors) / len(factors)
    return all(abs(f - avg) / avg < 0.02 for f in factors)
```

---

## **SCREENSHOT DESCRIPTIONS**

### **1. Outlook Folders**
- BID REQUEST folder expanded showing Jeff/Joe/Rich/Mike E subfolders

### **2. KeyedIn Dashboard**  
- Dark gray left menu, CRM visible, widgets showing "No Tasks"

### **3. Contact Management**
- Quote Number search selected, search box ready

### **4. Quote List (Northwestern Mutual)**
- Mix of BID REQUEST, BID COMPLETED, Sales Orders

### **5. Quote Detail (Valley Church)**
- Three tabs: Description, Construction, Attachments
- Quote #39657

### **6. G: Drive Navigation**
- Valley Church folder showing messy file organization
- Multiple dates, versions, file types

### **7. CorelDRAW Open Dialog**
- Navigating to find 0725-39657.cdr file

### **8. CorelDRAW Zoomed Out**
- Multiple versions visible
- BRADY TAKEOFF section
- Circled final version
- Building photos for reference

---

## **KEY INSIGHTS & PAIN POINTS**

1. **Multi-System Complexity**: 7+ software programs
2. **No Standardization**: Every customer folder different
3. **Scale Always Wrong**: Must verify every time
4. **Version Control Nightmare**: Everything in one file
5. **Legacy Systems**: 20+ year old KeyedIn interface
6. **Missing Dimensions**: Designers never give everything

---

## **NEXT SESSION AGENDA**

### **1. Scale Verification Process**
- Show measuring 5.5" on screen = 22" actual
- Calculate factor (4x)
- Apply to all measurements

### **2. Measurement Extraction**
- What CRN didn't dimension
- Letter spacing
- Return depths from side view
- Individual elements

### **3. Eagle Template Macros**
- How to run them
- What they calculate
- Output format

### **4. Bluebeam Process**
- Calibration tool (Ctrl+Alt+C)
- Never trust typed scale
- Measurement export

### **5. Excel Integration**
- Materials calculation
- Labor hours
- Final pricing

---

## **REMEMBER FOR NEXT TIME**

1. **You're BRADY** doing the takeoff
2. **CRN** is the designer (usually accurate scales)
3. **Valley Church** wants both edge-lit and halo-lit options
4. **15-45 minutes** is your target time per quote
5. **Everything is in one CorelDRAW file** - don't delete anything!

---

## **Save This Document As:**
`Sign_Shop_Complete_Workflow_Package.md`

**This single document contains everything you need to continue exactly where we left off!**